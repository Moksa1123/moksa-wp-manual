# 06.01 外掛基礎結構 (外掛標頭)

大家好，我是 Moksa 的首席課程導師。

歡迎來到「MoksaWP - 佈景主題與外掛開發」課程的第六章。從這個章節開始，我們將正式踏入 WordPress 外掛開發的精彩世界。開發外掛能讓你將 WordPress 的功能無限延伸，打造出完全客製化的解決方案。

在我們撰寫任何神奇的功能之前，必須先學會如何讓 WordPress「認識」我們的外掛。這一切都始於一個被稱為「**外掛標頭 (Plugin Header)**」的特殊註解區塊。

---

### 什麼是外掛標頭？

簡單來說，**外掛標頭**是一段寫在 PHP 檔案最開頭的特殊格式註解。WordPress 會掃描 `wp-content/plugins` 資料夾內的所有 PHP 檔案，當它讀到這個標頭時，就會知道「嘿！這是一個外掛！」，然後將標頭中提供的資訊（如名稱、描述、版本號等）顯示在後台的「外掛」管理頁面中。

如果沒有這個標頭，就算你的 PHP 檔案裡寫了多麼強大的程式碼，WordPress 也會完全忽略它，你將無法在後台看到也無法啟用它。

### 開發前置準備

在開始動手前，請確保你已經準備好我們的標準開發環境：

1.  **本地伺服器:** **LocalWP**。我們所有的開發都會在本地電腦上進行，安全又快速。
2.  **程式碼編輯器:** **VS Code**。這是我們推薦的編輯器，擁有強大的語法提示和擴充功能。

---

### (實作) 建立你的第一個外掛檔案

現在，讓我們一起動手建立一個最基礎的外掛。這個外掛目前不會有任何功能，我們的目標只有一個：**讓它成功出現在 WordPress 後台的外掛清單中**。

#### 步驟 1：建立外掛資料夾與主檔案

首先，我們要養成一個**非常重要**的好習慣：**為每一個外掛建立一個專屬的資料夾**。這能避免檔案命名衝突，也方便管理。

1.  啟動 LocalWP，並開啟你的開發網站。
2.  進入網站的資料夾，導覽至 `app/public/wp-content/plugins/`。
3.  在此路徑下，建立一個新的資料夾。資料夾的名稱應該是獨一無二的，通常會用你的品牌或功能名稱，並用 `-` 分隔。例如：`moksa-my-first-plugin`。
4.  進入 `moksa-my-first-plugin` 資料夾，在裡面建立一個 PHP 檔案。**Moksa 技巧**：通常，我們會讓主檔案的名稱與資料夾名稱相同，這樣更容易識別。例如：`moksa-my-first-plugin.php`。

你的檔案結構現在應該是這樣：
`.../wp-content/plugins/moksa-my-first-plugin/moksa-my-first-plugin.php`

[截圖] 顯示在 VS Code 或檔案總管中的資料夾與檔案結構。

#### 步驟 2：撰寫外掛標頭 (Plugin Header)

用 VS Code 開啟你剛剛建立的 `moksa-my-first-plugin.php` 檔案，然後貼上以下程式碼。

```php
<?php
/**
 * Plugin Name: Moksa 的第一個外掛
 */
```

是的，你沒看錯！理論上，一個外掛標頭**最少只需要 `Plugin Name` 這一個欄位**。只要有了這一行，WordPress 就能辨識出它是一個外掛。

然而，在專業開發中，我們絕對不會只寫這一行。一個完整的標頭能提供更多有用的資訊。

讓我們把它擴充成一個更專業的版本：

```php
<?php
/**
 * Plugin Name:       Moksa 的第一個外掛
 * Plugin URI:        https://moksaweb.com/plugins/my-first-plugin
 * Description:       這是我在 MoksaWP 課程中學習開發的第一個 WordPress 外掛。
 * Version:           1.0.0
 * Requires at least: 5.8
 * Requires PHP:      7.4
 * Author:            你的名字
 * Author URI:        https://your-website.com
 * License:           GPL v2 or later
 * License URI:       https://www.gnu.org/licenses/gpl-2.0.html
 * Text Domain:       moksa-my-first-plugin
 * Domain Path:       /languages
 */
```

#### 步驟 3：理解各個標頭欄位的意義

讓我們逐一解析這些欄位：

*   `Plugin Name`: **(必填)** 外掛的名稱，會顯示在後台外掛清單的主要位置。
*   `Plugin URI`: 介紹這個外掛的官方網頁，使用者可以點擊「檢視詳情」找到它。
*   `Description`: 一段簡短的描述，說明這個外掛的功能。
*   `Version`: 外掛的版本號。當你更新外掛時，應該要遞增這個數字。WordPress 會根據這個版本號提示使用者更新。
*   `Requires at least`: 這個外掛要求的 WordPress 最低版本。如果網站的 WordPress 版本過低，將無法啟用。
*   `Requires PHP`: 這個外掛要求的 PHP 最低版本。
*   `Author`: 外掛作者的名稱。
*   `Author URI`: 作者的個人或公司網站連結。
*   `License`: 版權宣告，WordPress 社群最常見的是 `GPL v2 or later`。
*   `License URI`: 版權宣告條文的完整連結。
*   `Text Domain`: 為了「國際化 (i18n)」準備的欄位，它告訴 WordPress 在載入翻譯檔時要尋找的唯一識別碼。**Moksa 技巧**：**強烈建議**將 Text Domain 設定為與你的外掛資料夾名稱（slug）相同，這是社群的最佳實踐。
*   `Domain Path`: 翻譯檔（.mo / .po）所在的資料夾路徑。通常我們會建立一個名為 `languages` 的資料夾來存放。

#### 步驟 4：在後台驗證你的外掛

儲存你的 PHP 檔案後，回到 WordPress 後台。

1.  點擊左側選單的「**外掛**」>「**已安裝的外掛**」。
2.  你現在應該可以在清單中看到你剛剛建立的「**Moksa 的第一個外掛**」了！
3.  你會看到我們在標頭中填寫的所有資訊，如描述、版本、作者等，都正確地顯示出來。

[截圖] 顯示 WordPress 後台外掛清單，並用紅框圈出剛剛建立的新外掛及其所有資訊。

你可以試著點擊「**啟用**」。雖然它目前不會做任何事，但能夠成功啟用，代表你的外掛基礎結構是完全正確的！

### Moksa 技巧與重點回顧

1.  **結構是王道**：永遠為你的外掛建立一個獨立、命名唯一的資料夾。
2.  **標頭要完整**：即使只有 `Plugin Name` 是必填的，一個完整的標頭展現了你的專業度，也方便日後維護與發布。
3.  **為翻譯做準備**：從第一天開始，就養成加入 `Text Domain` 的好習慣。這對未來的擴充性至關重要。
4.  **版本控制**：雖然本章節沒提到，但在你完成第一個檔案後，這就是初始化 **Git** 專案的最佳時機。專業開發離不開版本控制。

恭喜你！你已經成功跨出了外掛開發的第一步。在下一個單元，我們將學習如何使用 `hook` (鉤子)，讓這個外掛開始執行一些真正的程式碼。