# 11.01 (觀念) Headless WP (Gatsby, Next.js) 優缺點

嗨，歡迎來到 MoksaWP 開發者課程的進階章節。我是你在 Moksa 的首席課程導師。

在前面的課程中，我們已經深度掌握了如何透過佈景主題與外掛，打造功能強大、效能優異的傳統 WordPress 網站。今天，我們要探討一個在現代 Web 開發中越來越熱門的架構——**Headless WordPress**，並特別聚焦於搭配 **Gatsby** 或 **Next.js** 這類前端框架的優缺點。

這堂課是**觀念課**，我們的目標不是動手實作，而是建立一個清晰的認知地圖，幫助你判斷在什麼樣的專案情境下，應該選擇傳統 WordPress 架構，又在什麼時候，Headless 會是更佳的解決方案。

---

### 什麼是傳統的 WordPress 架構？

在我們深入 Headless 之前，讓我們先快速回顧一下我們最熟悉的「傳統」WordPress 架構。

在一個標準的 WordPress 網站中，前端（訪客看到的畫面）和後端（WordPress 管理後台）是緊密耦合（Coupled）在一起的。這個架構也被稱為 **Monolithic (單體式架構)**。

它的運作流程大致如下：
1.  使用者在瀏覽器輸入你的網址。
2.  請求被送到你的主機（Server）。
3.  WordPress 的核心、佈景主題與外掛透過 PHP 程式碼，向 MySQL 資料庫查詢資料。
4.  伺服器將查詢到的資料與 PHP 樣板（Template）結合，動態生成一個完整的 HTML 頁面。
5.  最後，這個 HTML 頁面被回傳到使用者的瀏覽器上呈現。

這個架構的最大優點是**整合度高、生態系成熟**。從頁面編輯器（如 Kadence Blocks, Elementor）的「即時預覽」，到 WooCommerce 的結帳流程，再到各種外掛的功能，一切都無縫整合在同一個系統內。

`[截圖：傳統 WordPress 架構圖，顯示瀏覽器 -> 伺服器 (PHP/WordPress/MySQL) -> 瀏覽器]`

---

### 什麼是 Headless WordPress？

**Headless (無頭模式)**，又稱為 **Decoupled (分離式架構)**，核心概念就是將「頭」（前端呈現層）與「身體」（後端內容管理）徹底分開。

在這個架構下：
*   **WordPress 的角色轉變了**：它不再負責生成給使用者看的 HTML 頁面。它的核心任務變成了一個純粹的**內容管理系統 (CMS)**，只負責儲存、管理內容（文章、頁面、產品、ACF 欄位等），並透過 API 將這些內容以結構化的資料格式（通常是 JSON）提供出來。
*   **前端的角色**：由一個獨立的應用程式來負責。這個應用程式會透過 API 向 WordPress 取得資料，然後用自己的技術（例如 React.js）來渲染頁面，最終呈現給使用者。

我們課程中提到的 **Gatsby** 和 **Next.js** 就是目前最主流的兩個用來打造 Headless 前端的 JavaScript 框架。

`[截圖：Headless WordPress 架構圖，顯示 WordPress (後端/CMS) <- API -> 前端框架 (Gatsby/Next.js) -> 瀏覽器/App]`

WordPress 原生就內建了 **WP REST API**，這也是 Headless 架構的基石。開發者也可以選擇安裝外掛來使用 **GraphQL**，這是另一種更現代、更有效率的 API 查詢語言。

---

### Headless WordPress 的優點 (Pros)

為什麼開發者社群對 Headless 趨之若鶩？它確實帶來了許多令人興奮的優勢。

#### 1. 極致的網站效能

這是 Headless 最大的賣點。像 Gatsby 和 Next.js 這類框架，可以將你的網站預先編譯成**靜態的 HTML、CSS 和 JavaScript 檔案**。

*   **無須資料庫查詢**：當使用者訪問網站時，他們直接從 CDN (內容分發網路) 取得這些靜態檔案，完全不需要等待伺服器執行 PHP 和查詢資料庫。這使得網站的載入速度**快得驚人**。
*   **TTFB (Time to First Byte) 極低**：因為回傳的是靜態檔案，伺服器響應時間可以被壓縮到極致。
*   **Moksa 技巧**：雖然我們使用 WP Rocket 已經可以將傳統 WordPress 網站優化得很快，但 Headless 的靜態生成 (SSG, Static Site Generation) 在效能的天花板上，理論上可以達到比快取更高的層級。

#### 2. 更高的安全性

因為前端和後端是分離的，你的 WordPress 後台可以被更好地保護起來。

*   **減少攻擊面**：公眾訪客完全接觸不到你的 WordPress 後端伺服器，他們只會與部署在 Vercel、Netlify 或 CDN 上的前端應用互動。
*   **隱藏後台**：你可以透過防火牆規則，將 WordPress Admin 的登入入口 (wp-admin) 設定為只允許公司內部 IP 訪問，大大降低了被暴力破解或漏洞攻擊的風險。

#### 3. 卓越的開發者體驗 (DX) 與彈性

對於開發者來說，這是一個巨大的吸引力。

*   **現代化技術棧**：你可以使用 React、Vue、Svelte 等現代 JavaScript 框架，享受它們帶來的元件化開發、狀態管理、熱重載等高效開發體驗。
*   **Git-based Workflow**：前端專案可以完美整合 Git 版本控制與 CI/CD (持續整合/持續部署) 流程。每一次的程式碼推送都可以自動觸發建置與部署。
*   **前端自由度高**：你不再受限於 WordPress 的主題結構和 The Loop。你可以用任何你喜歡的方式來組織你的程式碼和打造使用者介面。

#### 4. 多渠道內容發佈 (Omnichannel)

當 WordPress 成為一個純粹的內容中心，同樣的內容可以輕易地被發佈到不同的平台。你可以用同一套 WordPress 後台的資料，同時供應給：
*   一個用 Next.js 打造的官方網站。
*   一個用 React Native 開發的手機 App。
*   一個商場裡的觸控螢幕。
*   一個 IoT 裝置。

---

### Headless WordPress 的缺點 (Cons)

聽起來很美好，對吧？但 Headless 架構並非萬靈丹，它帶來了新的挑戰與權衡 (Trade-offs)。

#### 1. 大幅增加的複雜性

這是採用 Headless 之前**必須**慎重評估的第一點。

*   **雙重託管與維護**：你至少需要維護兩個獨立的系統：一個是 WordPress 後端的伺服器，另一個是託管前端應用的平台（如 Vercel, Netlify）。
*   **建置流程 (Build Process)**：每次在 WordPress 後台更新內容（例如發佈一篇文章），你都需要觸發一個「建置」流程，讓前端框架重新抓取資料、生成新的靜態檔案並部署。這個流程可能需要幾十秒到幾分鐘不等。
*   **技術門檻高**：團隊成員必須同時精通 WordPress 開發 (PHP, ACF, CPT) **和** 現代 JavaScript 框架 (React, Next.js)。

#### 2. 失去 WordPress 生態系的部分優勢

許多我們習以為常的 WordPress 功能，在 Headless 架構下會失效或需要大量客製化開發。

*   **即時預覽 (Live Preview)**：文章編輯頁面的「預覽」按鈕**直接失效**。因為前端是另一個獨立的網站，WordPress 無法知道該如何呈現它。這需要額外的開發來實現。
*   **頁面編輯器**：像 Elementor 或 Kadence Blocks 這類所見即所得的編輯器，其核心價值在於「前端編輯」。在 Headless 架構下，這個體驗被完全破壞了。雖然你可以用區塊編輯器 (Gutenberg) 作為結構化資料的輸入工具，但你無法在後台看到它在前端的真實樣貌。
*   **佈景主題與外掛相容性**：**絕大多數**的 WordPress 外掛，特別是那些會在前端輸出內容的（例如：Contact Form 7、SEO 外掛的 Schema 輸出、社群分享按鈕），都無法直接運作。你需要在前端專案中，自己手動重新打造這些功能。
*   **WooCommerce**：要將 WooCommerce 網站 Headless 化是一個巨大的工程。雖然有 API 可以使用，但從商品頁、購物車、結帳流程到會員中心，幾乎所有功能都需要在前端重新開發，這會失去 WooCommerce 生態系帶來的大量現成金流、物流外掛的便利性。

#### 3. 成本可能更高

*   **開發成本**：由於複雜性高，需要重新開發許多原生功能，專案的初始開發時間與成本通常遠高於傳統 WordPress 網站。
*   **維護成本**：你需要支付 WordPress 主機費用，可能還需要支付前端託管平台（如 Vercel）的費用，特別是當網站規模變大、建置次數變多時。

#### 4. SEO 需要手動處理

在傳統 WordPress 中，我們安裝 Rank Math SEO，它會自動處理 Sitemap、meta tags、Schema 標記等。但在 Headless 架構中，這些**全部都需要你在前端專案中手動實作**。你需要透過 API 從 WordPress 取得 SEO 數據（Rank Math 有提供 REST API），然後在 Next.js 或 Gatsby 的程式碼中正確地將它們渲染到頁面的 `<head>` 裡。

---

### Moksa 團隊觀點：我該選擇 Headless 嗎？

了解了優缺點後，我們來總結一下，到底什麼時候該用，什麼時候不該用。

#### **適合採用 Headless 的情境：**

*   **內容驅動的大型網站**：例如新聞媒體、大型部落格、文件中心。這類網站對**效能和安全性**的要求極高，且內容結構相對單純。
*   **需要多渠道發佈的專案**：當 WordPress 需要作為網站、App 和其他應用的統一內容來源時。
*   **開發團隊技術棧匹配**：團隊成員對 React 和現代前端開發流程非常熟悉，並且享受這樣的開發模式。
*   **對網站視覺與互動有高度客製化要求**：當你希望打造一個不受 WordPress 主題框架限制、擁有極度豐富動畫與互動的網站時。

#### **不適合採用 Headless 的情境：**

*   **標準中小型企業網站、形象網站**：這類網站使用 Kadence Blocks 搭配 WP Rocket 的傳統架構，已經可以達到極佳的效能，開發速度快、成本低，且客戶可以輕鬆使用頁面編輯器維護。
*   **功能複雜的電子商務網站**：對於大多數電商專案，WooCommerce 龐大的生態系（金流、物流、行銷外掛）是巨大的資產。貿然選擇 Headless 會拋棄這些優勢，導致開發成本和風險失控。
*   **預算與時間有限的專案**：Headless 的學習曲線和開發複雜度不容小覷。
*   **網站主要由非技術背景的客戶維護**：失去即時預覽和所見即所得的編輯體驗，對客戶來說會是一場災難。

> **Moksa 技巧：**
> 在考慮 Headless 之前，先問自己一個問題：「**我遇到的問題，是傳統 WordPress 架構（即使經過深度優化）真的無法解決的嗎？**」
> 大多數情況下，一個基於優質佈景主題 (Kadence)、高效能主機、搭配 WP Rocket 快取和 ShortPixel 圖片壓縮的傳統網站，已經能滿足 95% 以上的商業需求。**不要為了技術而技術**，選擇最適合專案目標、預算和團隊能力的架構，才是最專業的決定。

### 總結

Headless WordPress 是一個強大且令人興奮的架構，它為 WordPress 的未來開闢了新的可能性。它將 WordPress 從一個網站平台，提升到了一個可以驅動任何前端應用的內容引擎。

然而，它並不是取代傳統 WordPress 的「銀彈」。它是一種權衡，用**開發的複雜性**去交換**執行的極致效能與彈性**。

作為一名專業的 WordPress 開發者，理解這兩種架構的優劣與適用場景，將讓你能夠在面對不同專案時，做出最明智的技術選型。在接下來的課程中，我們將會實際動手，帶你體驗 Headless WordPress 的開發流程。