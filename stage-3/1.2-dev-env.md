# 01.02 本地端開發 (LocalWP, Docker)

歡迎來到佈景主題與外掛開發的第一個實作章節！在我們開始撰寫任何程式碼之前，建立一個**穩定、高效且與線上環境隔離**的「**本地端開發環境**」是所有專業開發者的第一步。這就像是建築師的草圖桌、廚師的備用廚房，你可以在這裡盡情實驗、測試、犯錯，而完全不用擔心影響到正在線上運作的網站。

本章節我們將介紹並實作兩種在 Moksa 團隊中最常被使用的本地端開發工具：**LocalWP** 與 **Docker**。

---

### 為什麼需要本地端開發環境？

在你的個人電腦上建立一個完整的網站環境（包含伺服器、PHP、資料庫、WordPress 檔案），有以下幾個至關重要的好處：

1.  **安全性：** 你可以在一個完全離線的環境中進行開發與測試，不必擔心駭客攻擊或操作失誤導致線上網站癱瘓。
2.  **速度：** 在本地端操作檔案、上傳媒體、測試功能，反應速度極快，因為所有資源都在你的電腦上，不受網路速度影響。
3.  **便利性：** 即使在沒有網路的環境（例如：飛機上、高鐵上），你依然可以持續進行開發工作。
4.  **成本效益：** 你不需要為每一個開發中的專案都租用一台主機，可以在一台電腦上同時運行數十個專案。
5.  **版本控制：** 本地端環境是整合 Git 進行版本控制的最佳起點，這是團隊協作與專業開發流程的基石。

---

## 方案一：LocalWP - 為 WordPress 量身打造的極速開發利器

**LocalWP** (前身為 Local by Flywheel) 是一款免費且極其易用的圖形化介面工具，專門為 WordPress 開發者設計。它將設定伺服器環境的複雜過程簡化為幾次點擊，是我們**推薦給絕大多數開發者，尤其是初學者的首選方案**。

**優點：**
*   **一鍵安裝 WordPress：** 幾秒鐘內就能建立一個全新的 WordPress 網站。
*   **環境切換自如：** 可自由選擇不同的 PHP 版本、Web Server (Nginx/Apache)、MySQL 版本。
*   **內建實用工具：**
    *   **SSL 憑證：** 一鍵為本地網站啟用 HTTPS。
    *   **MailHog：** 攔截所有 WordPress 發出的 Email (如 WooCommerce 訂單通知、FluentCRM 自動化郵件)，方便在本機直接查看與除錯。
    *   **Live Links：** 產生一個臨時的公開網址，讓你可以將本地端的網站分享給客戶或同事預覽。
    *   **WP-CLI 整合：** 直接在 LocalWP 內開啟終端機，使用強大的 WP-CLI 指令。

### (實作) 安裝與建立你的第一個本地站點

**步驟 1：下載與安裝 LocalWP**

前往 LocalWP 官方網站 (https://localwp.com/) 下載符合你作業系統 (Windows, Mac, Linux) 的安裝檔並完成安裝。

``
*示意圖：LocalWP 官網下載頁面。*

**步驟 2：建立新網站 (Create a new site)**

1.  打開 LocalWP 應用程式，點擊左下角的「+」按鈕。
2.  選擇「Create a new site」，然後點擊「Continue」。
3.  **輸入你的網站名稱**，例如 `moksa-dev`。LocalWP 會自動幫你產生一個本地網域 (e.g., `moksa-dev.local`)。
    *   **Moksa 技巧：** 在「Advanced options」中，你可以自訂這個網域，或是網站檔案的存放路徑。
4.  選擇你的開發環境。
    *   **Preferred (推薦)：** 使用 LocalWP 推薦的最新穩定環境配置。
    *   **Custom：** 自訂 PHP 版本、Web Server 類型與資料庫版本。這在需要模擬特定主機環境時非常有用。
5.  **設定 WordPress 管理員帳號**：輸入你的**使用者名稱 (Username)**、**密碼 (Password)** 與 **電子郵件 (Email)**。
6.  點擊「Add Site」。LocalWP 將會自動下載 WordPress、建立資料庫、並完成所有設定。過程可能需要數分鐘。

``
*示意圖：LocalWP 建立新網站的步驟引導畫面，包含站台名稱、環境選擇、WP 帳號設定。*

**步驟 3：啟動與管理你的網站**

網站建立完成後，你會看到網站的管理儀表板。

*   點擊右上角的「**WP Admin**」按鈕，可以直接登入 WordPress 後台。
*   點擊「**Open Site**」按鈕，可以在瀏覽器中開啟你的本地網站前台。

在這個儀表板上，你還可以輕鬆找到資料庫管理工具 (Adminer)、啟用 SSL、開啟 MailHog 等功能。

``
*示意圖：LocalWP 單一網站的管理儀表板，標示出 WP Admin, Open Site, SSL, Database 等重要功能區塊。*

---

## 方案二：Docker - 終極客製化與團隊協作的選擇

**Docker** 是一個更進階、更強大的工具，它使用「**容器化 (Containerization)**」技術來建立開發環境。你可以把它想像成一個個極度輕量化的獨立虛擬機，每個容器都包含了一個應用程式所需的所有東西：程式碼、執行環境、系統工具、函式庫等。

對於 WordPress 開發來說，我們通常會使用 `Docker Compose` 來同時啟動並管理多個容器，例如：一個跑 Nginx/Apache 的容器、一個跑 PHP 的容器、一個跑 MySQL 的容器。

**優點：**
*   **環境一致性：** 只要團隊成員使用同一個 `docker-compose.yml` 設定檔，就能保證每個人的開發環境 100% 完全相同，徹底解決「在我電腦上可以跑啊！」的經典問題。
*   **高度客製化：** 你可以精準控制每一個元件的版本與設定，完美複製線上主機的環境。
*   **資源隔離：** 每個專案的環境都是完全隔離的，不會互相干擾。
*   **可攜性與擴展性：** 非常容易整合到 CI/CD (持續整合/持續部署) 流程中，是大型專案與企業級開發的標準。

**挑戰：**
*   學習曲線較為陡峭，需要理解容器、映像檔、網路、儲存卷等概念。
*   初始設定比 LocalWP 複雜，需要手動撰寫設定檔。

### (實作) 使用 Docker Compose 建立 WordPress 環境 (概念性)

這個實作旨在讓你理解 Docker 的運作原理，而非完整的 Docker 教學。

**步驟 1：安裝 Docker Desktop**

前往 Docker 官網 (https://www.docker.com/products/docker-desktop/) 下載並安裝 Docker Desktop。它包含了 Docker 引擎、Docker CLI 客戶端以及 Docker Compose。

**步驟 2：建立專案資料夾與 `docker-compose.yml` 檔案**

1.  在你的電腦上建立一個新的專案資料夾，例如 `moksa-docker-project`。
2.  在資料夾內，建立一個名為 `docker-compose.yml` 的檔案，並貼上以下內容：

```yaml
version: '3.8'

services:
  # MySQL 資料庫服務
  db:
    image: mysql:8.0 # 使用 MySQL 8.0 的官方映像檔
    container_name: moksadb
    volumes:
      - db_data:/var/lib/mysql # 將資料庫資料持久化儲存
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: your_strong_root_password # **請務必更換為高強度密碼**
      MYSQL_DATABASE: wordpress
      MYSQL_USER: wordpressuser
      MYSQL_PASSWORD: your_strong_user_password # **請務必更換為高強度密碼**

  # WordPress 服務
  wordpress:
    image: wordpress:latest # 使用最新的 WordPress 官方映像檔
    container_name: moksawp
    depends_on:
      - db # 指定此服務依賴 db 服務，會先等 db 啟動
    ports:
      - "8000:80" # 將本機的 8000 port 映射到容器的 80 port
    restart: always
    environment:
      WORDPRESS_DB_HOST: db:3306 # 使用服務名稱 'db' 作為主機名稱
      WORDPRESS_DB_USER: wordpressuser
      WORDPRESS_DB_PASSWORD: your_strong_user_password # **密碼需與上方 db 設定一致**
      WORDPRESS_DB_NAME: wordpress
    volumes:
      - ./wp-content:/var/www/html/wp-content # 將本地的 wp-content 資料夾掛載進去，方便開發

volumes:
  db_data: {} # 定義一個 volume 來儲存資料庫資料
```

**Moksa 技巧：** `volumes` 的設定是 Docker 開發的關鍵。`./wp-content:/var/www/html/wp-content` 這行程式碼的意思是，將你電腦上 `docker-compose.yml` 檔案旁邊的 `wp-content` 資料夾，直接「同步」到 WordPress 容器內部對應的路徑。這樣你就可以使用 VS Code 等編輯器在本地直接修改主題與外掛的檔案，變更會立即生效。

**步驟 3：啟動環境**

1.  打開你的終端機 (Terminal) 或命令提示字元 (Command Prompt)。
2.  使用 `cd` 指令切換到你的專案資料夾 (`moksa-docker-project`)。
3.  執行指令：
    ```bash
    docker-compose up -d
    ```
    *   `-d` 代表在背景 (detached mode) 執行。

Docker 會開始下載所需的映像檔 (image) 並根據你的設定檔建立並啟動容器 (container)。

``
*示意圖：終端機中執行 docker-compose up -d 後，顯示 pulling images, creating and starting containers 的過程。*

**步驟 4：完成 WordPress 安裝**

打開瀏覽器，前往 `http://localhost:8000`。你會看到熟悉的 WordPress 五分鐘安裝畫面，選擇語言、設定網站標題與管理員帳號後，即可完成安裝。

---

### 總結與 Moksa 建議

| 特性 | LocalWP | Docker |
| :--- | :--- | :--- |
| **易用性** | ⭐⭐⭐⭐⭐ (極度簡單，圖形介面) | ⭐⭐ (需要學習指令與設定檔) |
| **客製化彈性** | ⭐⭐⭐ (提供常用選項) | ⭐⭐⭐⭐⭐ (完全可控，可複製任何環境) |
| **啟動速度** | ⭐⭐⭐⭐ (非常快) | ⭐⭐⭐ (初次需下載映像檔，後續快) |
| **團隊協作** | ⭐⭐ (可透過匯出/匯入，但非主流) | ⭐⭐⭐⭐⭐ (透過 Git 管理設定檔，確保環境一致) |
| **適用情境** | 個人開發者、自由工作者、小型團隊、快速原型製作 | 中大型團隊、複雜專案、需與 CI/CD 整合、追求極致環境控制 |

**Moksa 團隊建議：**

> 對於 95% 的 WordPress 開發情境，包括主題客製化、外掛開發與一般網站維護，**我們強烈建議從 LocalWP 開始**。它為你處理了所有繁瑣的環境設定，讓你能夠專注於 WordPress 本身的開發工作。當你的專案規模變大，團隊成員增加，或需要與自動化部署流程整合時，再投入時間學習 Docker，你會發現它是一個無比強大的工具。