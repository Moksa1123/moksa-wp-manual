# 09.02 (實作) 開發環境建置 (@wordpress/create-block)

嗨，歡迎來到 MoksaWP 開發課程的實作單元！在之前的章節中，我們討論了 Gutenberg 區塊開發的現代化流程。今天，我們將親自動手，使用 WordPress 官方推薦的工具 `@wordpress/create-block`，從零開始建置一個專業、標準化的區塊開發環境。

這個工具的美妙之處在於它是一個「**零設定 (Zero-configuration)**」的腳手架 (Scaffolding) 工具。你不需要自己去跟複雜的 Webpack、Babel、ESLint 等工具搏鬥，`@wordpress/create-block` 會為你處理好一切，讓你能夠專注在最重要的任務上：**打造出色的區塊**。

在本章節中，你將學會：
*   準備必要的開發前置工具。
*   使用一行指令快速建立一個新的區塊外掛。
*   理解 `create-block` 所產生的標準檔案結構。
*   啟動開發模式，並進行第一次的程式碼修改。

---

### 前置準備：你的開發工作站

在我們開始施展魔法之前，請確保你的電腦已經準備好以下幾項**必備工具**。這就像是廚師在烹飪前要先備好刀具與砧板一樣重要。

1.  **本地 WordPress 環境：**
    *   **Moksa 推薦：** 我們強烈建議使用 **LocalWP** (https://localwp.com/)。它可以讓你輕鬆地在你的電腦上建立、管理多個獨立的 WordPress 網站，是現代 WordPress 開發的必備利器。
    *   請確保你已經透過 LocalWP 建立了一個乾淨的 WordPress 測試站。

2.  **Node.js 與 npm：**
    *   `@wordpress/create-block` 是一個 Node.js 套件，因此你的電腦需要安裝 Node.js 環境。安裝 Node.js 會自動包含 npm (Node Package Manager)。
    *   你可以到 [Node.js 官網](https://nodejs.org/) 下載並安裝 **LTS (長期支援)** 版本。
    *   **如何檢查是否安裝成功？** 打開你的終端機 (Terminal) 或命令提示字元 (Command Prompt)，輸入以下指令：
        ```bash
        node -v
        npm -v
        ```
        如果能成功顯示版本號，代表安裝成功。

3.  **程式碼編輯器 (Code Editor)：**
    *   **Moksa 推薦：** **Visual Studio Code (VS Code)** 是目前業界的主流選擇，它免費、強大，且擁有豐富的擴充套件生態系。
    *   請先至 [VS Code 官網](https://code.visualstudio.com/) 下載並安裝。

4.  **終端機 (Terminal)：**
    *   你需要熟悉如何在你的作業系統上開啟並使用終端機。
    *   **macOS:** `Terminal.app` 或 `iTerm2`。
    *   **Windows:** `PowerShell` 或 `Windows Terminal`。

### 步驟 1：進入你的外掛資料夾

首先，我們必須在正確的位置執行指令。`create-block` 會建立一個完整的外掛，所以我們要在 WordPress 網站的 `plugins` 資料夾中進行操作。

1.  啟動你的 LocalWP 網站。
2.  找到你的網站路徑。通常會在 `~/Local Sites/<your-site-name>/app/public/`。
3.  打開你的終端機，並使用 `cd` (Change Directory) 指令移動到該網站的 `wp-content/plugins` 資料夾。

    **範例 (macOS/Linux):**
    ```bash
    cd ~/Local\ Sites/my-awesome-site/app/public/wp-content/plugins/
    ```

    **範例 (Windows):**
    ```bash
    cd C:\Users\YourUser\Local Sites\my-awesome-site\app\public\wp-content\plugins
    ```

`[截圖]`

### 步驟 2：執行 create-block 指令

現在，最神奇的時刻來了。在終端機中，輸入以下指令：

```bash
npx @wordpress/create-block moksa-first-block
```

讓我們來分解這個指令：

*   `npx`: 這是 npm 5.2+ 之後內建的工具，它可以在不安裝到全域的情況下，直接「執行」一個 npm 套件。
*   `@wordpress/create-block`: 這就是我們今天的主角，官方的區塊建立工具。
*   `moksa-first-block`: 這是你為這個新區塊（同時也是新外掛）所取的**名稱 (slug)**。**Moksa 技巧：** 命名請使用**全小寫**與**橫線 (`-`)**，這是 WordPress 的標準命名慣例。

按下 Enter 後，`create-block` 會開始自動下載所有需要的檔案、設定相依套件。這個過程可能需要幾分鐘，取決於你的網路速度。

`[截圖]`

當你看到終端機顯示類似 `Success! Plugin "Moksa First Block" created.` 的成功訊息時，就代表你的區塊開發環境已經建置完成了！就是這麼簡單！

### 步驟 3：啟用外掛並檢視成果

`create-block` 為你建立的是一個功能完整的外掛。因此，你需要到 WordPress 後台去啟用它。

1.  登入你的 LocalWP 網站後台。
2.  前往「**外掛**」>「**已安裝的外掛**」。
3.  你會看到一個名為「**Moksa First Block**」的新外掛，點擊「**啟用**」。

`[截圖]`

啟用後，讓我們來看看成果：
1.  新增或編輯任何一篇文章或頁面，進入區塊編輯器。
2.  點擊「+」新增區塊。
3.  在搜尋框中輸入 `moksa` 或在「Widgets (小工具)」分類下，你應該能找到一個名為「**Moksa First Block**」的新區塊。
4.  將它加入到你的頁面中。你會看到一個預設的區塊內容。

`[截圖]`

恭喜你！你已經成功建立並使用了你的第一個自訂 Gutenberg 區塊！

### 剖析 create-block 產生的檔案結構

現在，讓我們用 VS Code 打開剛剛建立的 `moksa-first-block` 資料夾，看看裡面到底有哪些東西。理解這個結構對於後續開發至關重要。

```
moksa-first-block/
├── build/                 # 編譯後的 JS/CSS 最終產物
├── node_modules/          # Node.js 相依套件
├── src/                   # 你的主要開發目錄 (Source Code)
│   ├── block.json         # **核心**：區塊的元數據設定檔
│   ├── edit.js            # **核心**：區塊在「編輯器」中的樣貌 (React Component)
│   ├── editor.scss        # 編輯器專用的 SCSS 樣式
│   ├── index.js           # 區塊的主要進入點，註冊區塊的地方
│   ├── save.js            # **核心**：區塊在「前台」儲存的樣貌 (React Component)
│   └── style.scss         # 前後台共用的 SCSS 樣式
├── .editorconfig          # 編輯器設定檔
├── .gitignore             # Git 忽略清單
├── moksa-first-block.php  # PHP 外掛主檔案
├── package.json           # Node.js 專案設定檔
└── readme.txt             # WordPress 外掛說明檔
```

**Moksa 技巧：** 你 95% 的開發時間都會花在 `src/` 這個資料夾中。尤其是 `block.json`、`edit.js` 與 `save.js` 這三個檔案，它們是構成一個區塊的靈魂。

### 步驟 4：啟動開發流程並修改你的區塊

`create-block` 不僅僅是建立檔案，它還內建了一套完整的開發工具鏈。

1.  **啟動開發模式：**
    *   在終端機中，確認你仍然在 `moksa-first-block` 資料夾內。
    *   執行以下指令：
        ```bash
        npm start
        ```
    *   這個指令會啟動「**監看 (watch)**」模式。它會持續監控 `src/` 資料夾內的任何檔案變動，一旦你儲存檔案，它就會**自動重新編譯**程式碼到 `build/` 資料夾。你不需要手動做任何事，這就是現代化前端開發的魅力！

2.  **進行第一次修改：**
    *   使用 VS Code 打開 `src/edit.js`。
    *   找到類似以下的程式碼片段 (可能會有些許不同)：
        ```jsx
        <p { ...useBlockProps() }>
            { __( 'Moksa First Block – hello from the editor!', 'moksa-first-block' ) }
        </p>
        ```
    *   將文字修改成你想要的內容，例如：
        ```jsx
        <p { ...useBlockProps() }>
            { __( '這是我的第一個 Moksa 區塊！在編輯器中顯示。', 'moksa-first-block' ) }
        </p>
        ```
    *   **儲存檔案 (Cmd+S 或 Ctrl+S)。**

3.  **驗證結果：**
    *   回到你的瀏覽器，重新整理你正在編輯的那篇文章。
    *   你會發現，區塊在編輯器中顯示的文字已經變成了你剛剛修改的樣子！

`[截圖]`

### 總結與下一步

在本章節中，我們完成了一個極為重要的里程碑。你已經學會使用 `@wordpress/create-block` 這個強大的工具來快速、標準化地建立一個 Gutenberg 區塊開發環境。我們從準備工具開始，到執行指令，最後成功地修改並看到了成果。

**重點回顧：**
*   開發前需要 **LocalWP**、**Node.js** 與 **VS Code**。
*   核心指令是 `npx @wordpress/create-block <your-block-name>`，且必須在 `wp-content/plugins` 目錄下執行。
*   開發時，主要的工作目錄是 `src/`。
*   `npm start` 是你最好的朋友，它會在你開發時自動編譯程式碼。

在接下來的章節，我們將會深入探索 `block.json` 的奧秘，學習如何為區塊新增「**屬性 (Attributes)**」來讓它變得動態且可互動。準備好了嗎？我們下個章節見！