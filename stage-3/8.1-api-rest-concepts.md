# 08.01 REST API 核心觀念 (JSON, Endpoints)

歡迎來到課程的第八章節！從這裡開始，我們將正式踏入 WordPress 開發的進階領域。本章節的重點是 **WordPress REST API**，這是現代 WordPress 開發的基石，無論是開發「無頭 (Headless) 網站」、手機 App、或是與第三方服務串接，都離不開它。

在這堂課中，我們將會打下堅實的理論基礎，理解幾個最重要的核心觀念。

---

### 什麼是 API 與 REST API？

在深入技術細節之前，讓我們先用一個生活化的例子來理解什麼是 API。

想像你去一家餐廳：
*   你 (Client / 客戶端) 想點一份牛排。
*   廚房 (Server / 伺服器) 負責烹煮牛排。
*   你不能直接闖進廚房跟廚師說你要什麼，你需要透過**服務生 (API)** 來點餐。

服務生會拿著**菜單 (API 文件)** 給你，上面列出了所有你可以點的菜色以及點餐規則。你告訴服務生你要的餐點，服務生將你的**請求 (Request)** 傳達給廚房。廚房準備好後，再由服務生將餐點 (資料) **回應 (Response)** 給你。

``

在這個比喻中：
*   **API (Application Programming Interface / 應用程式介面)** 就是那位服務生，他定義了一套標準化的溝通方式，讓客戶端與伺服器之間可以有效率地交換資訊，而不需要知道對方內部是如何運作的。

而 **REST (REpresentational State Transfer / 表現層狀態轉換)** 則是一套設計 API 的「風格」或「架構原則」，它不是一個具體的技術，而是一組設計指南。遵循 REST 原則設計的 API 就被稱為 **REST API**。它是目前網路上最流行、最廣泛使用的 API 設計風格。

**Moksa 技巧：** WordPress 從 4.7 版開始，就將 REST API 內建為核心功能。這代表你安裝好的任何一個 WordPress 網站，都已經內建了一個強大且完整的 API 服務，隨時可以被呼叫使用。

---

### REST API 的核心組件

一個典型的 REST API 請求與回應，主要由以下幾個部分組成：

#### 1. JSON (JavaScript Object Notation) - 數據的格式

如果說 API 是溝通的管道，那麼 **JSON** 就是雙方溝通時使用的「**通用語言**」。

JSON 是一種輕量級的資料交換格式，它非常容易讓人閱讀和編寫，同時也易於機器解析和生成。它的結構由「**鍵 (Key)**」和「**值 (Value)**」組成，看起來就像 JavaScript 的物件。

這是一個 WordPress 文章物件的 JSON 範例：

```json
{
  "id": 1,
  "date": "2023-10-27T14:30:00",
  "status": "publish",
  "title": {
    "rendered": "哈囉！世界"
  },
  "content": {
    "rendered": "<p>歡迎使用 WordPress。這是您的第一篇文章。編輯或者刪除它，然後開始撰寫文章吧！</p>",
    "protected": false
  },
  "author": 1
}
```

*   `"id": 1` 就是一組 Key-Value Pair。
*   `"title"` 的值是一個**巢狀物件 (Nested Object)**。
*   如果有多篇文章，它們會被包在一個**陣列 (Array)** `[ ... ]` 裡面。

**重要觀念：** 在 REST API 的世界裡，你收到的資料和傳送的資料，絕大多數都是 JSON 格式。

#### 2. Endpoints (端點) - 存取資料的網址

**Endpoint** 就是 API 暴露出來的特定 **URL (網址)**，每一個 Endpoint 都對應到一種特定的**資源 (Resource)**，例如文章、頁面、使用者或 WooCommerce 商品。

你可以把 Endpoint 想像成是服務生菜單上的每一個「**菜色項目**」。你想取得文章列表，就要呼叫「文章列表」的 Endpoint；你想取得特定一篇文章，就要呼叫「單一文章」的 Endpoint。

WordPress REST API 的 Endpoint 結構通常如下：

`https://your-domain.com/wp-json/<namespace>/<version>/<route>`

*   `https://your-domain.com`: 你的網站網址。
*   `/wp-json/`: 這是 WordPress REST API 的固定前綴。
*   `<namespace>/<version>`: **命名空間**與**版本號**。
    *   WordPress 核心功能的命名空間是 `wp/v2`。
    *   WooCommerce 的命名空間可能是 `wc/v3`。
    *   你自己開發的外掛可以自訂命名空間，例如 `moksa/v1`。
*   `<route>`: **路由**，指向你想要操作的具體資源，例如 `posts` (文章)、`users` (使用者)。

**範例：**
*   取得所有文章：`https://your-domain.com/wp-json/wp/v2/posts`
*   取得 ID 為 123 的文章：`https://your-domain.com/wp-json/wp/v2/posts/123`
*   取得所有 WooCommerce 商品：`https://your-domain.com/wp-json/wc/v3/products`

#### 3. HTTP Methods (方法) - 你想做什麼操作

當你對一個 Endpoint 發出請求時，你還需要告訴伺服器你「**想做什麼**」。這是透過 **HTTP Methods (或稱 HTTP Verbs)** 來指定的。最常用的有四種，剛好對應到資料庫的 CRUD (Create, Read, Update, Delete) 操作：

*   **GET (讀取)**: 從伺服器**取得**資料。這是最常見的操作，例如讀取文章列表、讀取使用者資訊。當你在瀏覽器網址列輸入一個 Endpoint 時，就是發送了一個 GET 請求。
*   **POST (新增)**: 在伺服器上**建立**一個新的資源。例如發表一篇新文章、註冊一個新使用者。
*   **PUT / PATCH (更新)**: **更新**伺服器上已經存在的資源。例如修改一篇文章的標題或內容。
*   **DELETE (刪除)**: **刪除**伺服器上的資源。例如刪除一篇文章、移除一個使用者。

**重要觀念：** **Endpoint (網址)** 決定了你要對「**什麼資源**」進行操作，而 **HTTP Method (方法)** 決定了你要「**進行什麼操作**」。

| HTTP Method | CRUD 操作 | 範例 (`/wp/v2/posts`) |
| :---------- | :-------- | :-------------------- |
| **GET**     | Read      | 讀取文章列表          |
| **POST**    | Create    | 新增一篇文章          |
| **PUT**     | Update    | 更新一篇文章          |
| **DELETE**  | Delete    | 刪除一篇文章          |

---

### (實作) 實際探索你的 WordPress REST API

讓我們用最簡單的方式，親眼看看你的 WordPress 網站 API 長什麼樣子。

*   **環境準備：** 建議使用 **LocalWP** 建立的本地開發環境來進行測試，避免影響線上網站。

#### 步驟 1: 找到你的 API 根目錄

打開你的瀏覽器，在網址列輸入你的本地網站網址，並在後面加上 `/wp-json`。

例如： `http://my-local-site.local/wp-json/`

``

按下 Enter 後，你應該會看到一大串 JSON 格式的文字。這就是你的網站 API 的「**根端點 (Root Endpoint)**」，它像一份 API 地圖，告訴你這個網站提供了哪些命名空間以及它們底下的所有可用端點 (Endpoints)。

#### 步驟 2: 取得文章列表

現在，讓我們試著取得文章列表。在剛剛的網址後面，加上 WordPress 核心的端點 `wp/v2/posts`。

完整的網址是： `http://my-local-site.local/wp-json/wp/v2/posts`

``

按下 Enter 後，瀏覽器會顯示一個 JSON 陣列，裡面包含了你網站上最新的文章資料。每一篇文章都是一個 JSON 物件，包含了 ID、標題、內容、作者等詳細資訊。

**Moksa 技巧：** 瀏覽器預設只能發出 **GET** 請求。若要進行 POST、PUT、DELETE 等操作，我們需要使用專門的 API 測試工具，例如 **Postman** 或 **Insomnia**，這將在後續的課程中詳細介紹。

### 總結

恭喜你！你已經掌握了 WordPress REST API 最重要的幾個核心觀念：

1.  **REST API** 是一套標準化的溝通規則，讓不同應用程式可以交換資料。
2.  **JSON** 是 API 溝通時使用的標準資料格式。
3.  **Endpoint** 是指向特定資源的 URL。
4.  **HTTP Methods (GET, POST, PUT, DELETE)** 定義了你想要對資源執行的操作。

理解這些基礎觀念，是學習如何註冊自訂 API 端點、整合第三方服務，甚至是打造無頭 (Headless) WordPress 應用的第一步，也是最關鍵的一步。在接下來的課程中，我們將會基於這些觀念，進行更深入的實作練習。