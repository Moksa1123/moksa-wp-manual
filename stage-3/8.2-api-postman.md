# 08.02 (實務) 使用 Postman 測試 WP API

嗨，歡迎來到 MoksaWP 開發者課程！在前面的章節中，我們已經理解了 WordPress REST API 的基本概念。理論歸理論，身為一個專業的開發者，我們需要一個強大的工具來實際與 API 互動、測試、除錯。這個工具就是 Postman。

Postman 是一個廣受歡迎的 API 協作平台，它可以讓我們用圖形化介面輕鬆地發送各種 HTTP 請求 (GET, POST, PUT, DELETE 等)，並檢視詳細的回應。這對於開發無頭 (Headless) WordPress、手機 App、或是與第三方服務串接時，是不可或缺的技能。

在這堂課中，我們將從零開始，帶你學會如何安裝 Postman，並實際對我們在 **LocalWP** 環境中的 WordPress 網站，發送你的第一個 API 請求，包含公開資料的讀取，以及需要「驗證」身份的內容新增。

---

### 課前準備

在開始之前，請確保你已經準備好以下環境：

1.  **一個本機 WordPress 網站：** 我們強烈建議使用 **LocalWP** 建立的網站，這能確保環境單純。
2.  **安裝 Postman：** 請至 [Postman 官方網站](https://www.postman.com/downloads/) 下載並安裝符合你作業系統的免費版本。
3.  **漂亮的固定網址：** 為了讓 REST API 正常運作，請到 WordPress 後台的「設定」>「固定網址」，並**確認你使用的不是「純文字」格式**。通常，「文章名稱」是最好的選擇。

`[截圖：WordPress 後台的固定網址設定頁面，並圈選「文章名稱」選項]`

---

### 步驟 1：發送你的第一個 GET 請求 (讀取公開文章)

我們的第一個任務是「暖身」，嘗試從 WordPress 網站讀取一些公開的資料，例如已發佈的文章。這個操作不需要任何身份驗證。

1.  **打開 Postman 並建立新請求**
    打開你剛安裝好的 Postman，點擊左上角的 `+` 按鈕來建立一個新的請求分頁。

    `[截圖：Postman 介面，箭頭指向 `+` 按鈕]`

2.  **找出你的 API 端點 (Endpoint) URL**
    WordPress REST API 的路徑結構通常是 `你的網址/wp-json/wp/v2/`。如果要抓取文章列表，端點就是 `posts`。
    因此，完整的 URL 會是：`http://your-local-site.local/wp-json/wp/v2/posts`
    > **Moksa 技巧：** 請將 `http://your-local-site.local` 換成你在 LocalWP 裡的實際網址。

3.  **在 Postman 中設定並發送請求**
    *   在請求方式的下拉選單中，選擇 **GET** (這通常是預設值)。
    *   在右側的 URL 輸入框中，貼上你的完整 URL。
    *   點擊藍色的 **Send** 按鈕發送請求。

    `[截圖：Postman 介面，顯示請求方式為 GET，並填入了 posts 的端點 URL]`

4.  **分析回傳結果 (Response)**
    如果一切順利，你應該會在下方的「Response」區域看到一堆文字。
    *   **Status Code:** 確認右上角的狀態是 **`200 OK`**，這代表請求成功。
    *   **Body:** 在 Body 分頁中，你會看到一個 JSON 格式的陣列，裡面包含了你網站中最新的幾篇文章資料，例如 `id`, `date`, `slug`, `title`, `content` 等。

    `[截圖：Postman 的 Response 區塊，顯示 200 OK 狀態碼，以及 JSON 格式的文章資料]`

恭喜！你已經成功地透過 API 從 WordPress 讀取了資料。

---

### 步驟 2：設定身份驗證 (為了寫入資料)

讀取公開資料很簡單，但如果我們要新增文章、修改頁面、或刪除留言呢？這些操作都需要告訴 WordPress：「我是誰？我有沒有權限做這件事？」這就是「身份驗證 (Authentication)」。

雖然有很多種驗證方式，但從 WordPress 5.6 開始，核心內建了最安全且推薦的方式：**應用程式密碼 (Application Passwords)**。

1.  **在 WordPress 後台產生應用程式密碼**
    *   登入你的 WordPress 後台。
    *   前往「使用者」>「個人資料」。
    *   向下捲動找到「**應用程式密碼**」區塊。
    *   在「**新應用程式密碼名稱**」欄位中，輸入一個好記的名稱，例如 `Postman 測試`，然後點擊「新增應用程式密碼」。

    `[截圖：WordPress 個人資料頁面，圈選出「應用程式密碼」區塊]`

2.  **複製你的密碼**
    系統會產生一組**只會顯示這一次**的密碼，格式為 `xxxx xxxx xxxx xxxx xxxx xxxx`。
    ****請立刻點擊「複製」按鈕將它複製下來，並妥善保管。**一旦你離開這個頁面，這組密碼就再也找不回來了！**

    `[截圖：顯示已產生的應用程式密碼，並有明顯的提示說明只會顯示一次]`

3.  **在 Postman 中設定驗證資訊**
    *   回到 Postman，在你的請求分頁中，點擊下方的 **Authorization** (授權) 標籤。
    *   在 **Type** 下拉選單中，選擇 **Basic Auth**。
    *   在右側的欄位中，填入：
        *   **Username:** 你的 **WordPress 登入帳號** (例如 `admin`)。
        *   **Password:** **剛剛複製的那一長串應用程式密碼**，**不是**你的 WordPress 登入密碼！

    `[截圖：Postman 的 Authorization 標籤頁面，顯示已選擇 Basic Auth，並填入了 Username 和 Password]`

    > **Moksa 技巧：** Postman 會自動將你的帳號密碼轉換成 Base64 編碼，並加到請求的 Headers 中，這就是 Basic Auth 的運作原理。你可以在 Headers 分頁看到一個 `Authorization` 的鍵值對。

---

### 步驟 3：發送 POST 請求 (新增一篇文章)

準備工作都完成了，現在讓我們來挑戰真正的「寫入」操作——透過 API 新增一篇草稿文章。

1.  **設定請求方法與端點**
    *   將請求方法從 `GET` 改為 **POST**。
    *   URL 維持不變，一樣是文章的端點：`http://your-local-site.local/wp-json/wp/v2/posts`

2.  **設定請求主體 (Request Body)**
    我們要告訴 WordPress 新文章的標題和內容是什麼。這些資料要放在請求的「Body」中。
    *   點擊 **Body** 標籤。
    *   選擇 **raw** 選項。
    *   在最右邊的下拉選單中，選擇 **JSON**。
    *   在下方的文字輸入區，貼上以下 JSON 內容：
    ```json
    {
        "title": "這是一篇從 Postman 發佈的文章",
        "content": "哈囉！這篇文章是透過 WordPress REST API 和 Postman 自動建立的。",
        "status": "draft"
    }
    ```
    這段 JSON 資料代表：我們要建立一篇文章，標題是...，內容是...，並且狀態是「草稿 (draft)」。

    `[截圖：Postman 的 Body 標籤頁面，顯示已選擇 raw 和 JSON，並貼上了上述的 JSON 程式碼]`

3.  **發送請求並驗證結果**
    *   確認你的 **Authorization** 依然設定正確。
    *   點擊 **Send** 按鈕。
    *   **分析 Response:**
        *   **Status Code:** 你應該會看到 **`201 Created`**。`201` 是 HTTP 協定中代表「資源已成功建立」的標準狀態碼。
        *   **Body:** 回傳的 Body 內容會是剛剛建立好的那篇文章的完整 JSON 物件，你可以從中看到 WordPress 為它分配的新 `id`。
    *   **最終驗證:** 回到你的 WordPress 網站後台，點擊「文章」>「全部文章」。你會驚喜地發現，一篇標題為「這是一篇從 Postman 發佈的文章」的草稿文章，已經靜靜地躺在那裡了！

    `[截圖：WordPress 文章列表，顯示剛剛由 API 建立的草稿文章]`

---

### 總結與下一步

太棒了！在本堂課程中，你已經掌握了開發者與 WordPress API 互動的核心技能：

*   使用 Postman 發送 **GET** 請求來讀取公開資料。
*   了解身份驗證的重要性，並學會使用 WordPress 內建的 **應用程式密碼**。
*   在 Postman 中設定 **Basic Auth** 進行身份驗證。
*   發送 **POST** 請求，並夾帶 **JSON Body**，成功地在 WordPress 中建立了一筆新資料。

Postman 的功能遠不止於此。在接下來的課程中，我們將會探索如何使用 `PUT` 來更新文章，使用 `DELETE` 來刪除文章，以及如何利用 Postman 的「環境變數 (Environments)」和「集合 (Collections)」功能，更有效率地管理和測試你的 API，這也是 **Moksa 的標準開發流程**之一。

請務必親手操作一遍今天的練習，這將為你後續的佈景主題與外掛開發打下堅實的基礎。我們下堂課見！