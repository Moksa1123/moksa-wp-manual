# 09.01 Gutenberg 核心觀念 (Block, React, JSX)

歡迎來到課程的第九章！從這個章節開始，我們將正式踏入現代 WordPress 開發的核心——**Gutenberg (古騰堡) 區塊編輯器**。過去，開發者客製化 WordPress 後台大多依賴 Meta Box 或是短代碼 (Shortcode)，但這些方式在使用體驗上都有其極限。Gutenberg 的出現，徹底改變了 WordPress 的內容建立與網站佈局方式。

要成為一名頂尖的 WordPress 開發者，**掌握 Gutenberg 區塊開發是不可或缺的技能**。這不僅僅是為了寫文章，更是因為整個 WordPress 的未來，包括**全站編輯 (Full Site Editing)**，都完全建立在區塊的基礎之上。

在這堂課中，我們將專注於理解驅動 Gutenberg 的三大核心觀念：**區塊 (Block)**、**React** 以及 **JSX**。這三者是你未來開發自訂區塊的基石。

---

### 1. 什麼是「區塊 (Block)」？

在 Gutenberg 的世界裡，**所有內容都是一個區塊**。

一個段落是一個「段落區塊」、一張圖片是一個「圖片區塊」、一個標題是一個「標題區塊」。你可以將整個頁面或文章，看作是由無數個樂高積木（區塊）堆砌而成的作品。

``
*（示意圖：一張由各種區塊組成的 WordPress 編輯器畫面，例如標題、段落、圖片、按鈕等。）*

從開發者的角度來看，一個**區塊 (Block)** 是一個**獨立、可重複使用的內容單元**。它由兩大部分組成：

1.  **編輯器端的呈現 (JavaScript):** 這是在後台編輯文章時，使用者看到的樣子。它是一個互動式的介面，讓使用者可以輸入內容、調整設定（例如顏色、大小、對齊方式）。這部分主要是用 **React** 來建構的。
2.  **前端的儲存與呈現 (PHP/HTML):** 當使用者儲存文章時，區塊的內容會被轉換成特定的 HTML 格式，並儲存在資料庫的 `post_content` 欄位中。當訪客瀏覽網站時，WordPress 會將這段 HTML 渲染出來。開發者也可以選擇使用 PHP 在伺服器端動態渲染區塊，這適用於需要動態資料的場景（例如「最新文章」區塊）。

**Moksa 技巧：** 每個區塊的資料，在資料庫中都會被一對 HTML 註解包圍，例如 `<!-- wp:paragraph -->` 和 `<!-- /wp:paragraph -->`。這就是 WordPress 如何識別和解析不同區塊的方式。你可以直接在資料庫中看到這些標記。

---

### 2. 為什麼 Gutenberg 要使用「React」？

**React** 是由 Facebook (現為 Meta) 開發的一個強大的 JavaScript 前端函式庫，專門用來建構使用者介面 (UI)。WordPress 核心團隊選擇 React 作為 Gutenberg 的開發基礎，主要有以下幾個原因：

*   **元件化架構 (Component-Based):** React 的核心思想是將複雜的 UI 拆解成一個個獨立、可複用的「元件 (Component)」。這與 Gutenberg 的「區塊 (Block)」理念不謀而合。**每一個區塊，本質上就是一個 React 元件**。
*   **狀態管理 (State Management):** 在一個複雜的編輯器中，充滿了各種會變動的資料，例如文字內容、顏色設定、圖片 URL 等。React 提供了一套高效的方式來管理這些「狀態 (State)」，當狀態改變時，UI 會自動更新，讓開發者能專注於業務邏輯，而非手動操作 DOM。
*   **高效能與虛擬 DOM (Virtual DOM):** React 使用虛擬 DOM 來最小化對實際 DOM 的操作，這使得即使在非常複雜的編輯器介面中，也能保持流暢的效能。
*   **強大的生態系:** React 擁有龐大的開發社群和豐富的工具鏈，這為 Gutenberg 的長期發展提供了穩固的基礎。

**Moksa 技巧：** 你不需要成為 React 的頂尖專家才能開始開發區塊。初期，你只需要掌握 React 的幾個核心觀念：**元件 (Component)**、**屬性 (Props)**、**狀態 (State)** 和 **Hooks (例如 `useState`, `useEffect`)**。我們會在本課程的後續章節中，透過實際範例來逐一學習。

---

### 3. 什麼是「JSX」？

當你看到 Gutenberg 區塊的原始碼時，你會發現一種看起來很像 HTML，但又被寫在 JavaScript 檔案中的語法。這就是 **JSX (JavaScript XML)**。

JSX 是 React 的一種語法擴充，它允許我們在 JavaScript 中用類似 HTML 的方式來描述 UI 的結構。

**傳統的 JavaScript 寫法 (不使用 JSX):**
```javascript
// 使用 React 的 API 來建立一個帶有 class 的 div 元素
// 寫起來比較繁瑣且不易閱讀
React.createElement(
  'div',
  { className: 'greeting' },
  'Hello, Moksa Student!'
);
```

**使用 JSX 的寫法:**
```jsx
// 語法直觀，就像在寫 HTML 一樣
// 這段程式碼會被編譯成上面那段傳統的 JavaScript 寫法
const element = <div className="greeting">Hello, Moksa Student!</div>;
```
``
*（示意圖：左右對比的程式碼區塊，左邊是 `React.createElement`，右邊是等效的 JSX 語法，並用箭頭表示 JSX 會被編譯成前者。）*

**為什麼要用 JSX？**

*   **可讀性高：** 對於習慣 HTML 的開發者來說，JSX 非常直觀，可以清楚地看出 UI 的結構。
*   **開發效率：** 直接在 JavaScript 中撰寫 UI 結構，比手動呼叫 `createElement` 函式要快得多。
*   **錯誤檢查：** 在編譯過程中，可以提早發現語法錯誤（例如標籤未閉合）。

**重要觀念：** 瀏覽器本身並不認識 JSX。我們需要透過像 **Babel** 這樣的編譯工具，在開發過程中將 JSX 語法**轉換**為標準的 JavaScript，瀏覽器才能夠執行。幸運的是，WordPress 官方提供了一個名為 `**@wordpress/scripts**` 的工具包，它已經幫我們處理好了所有繁瑣的設定，我們只需要專注於撰寫程式碼即可。

---

### 總結：三者的關係

讓我們用一個簡單的流程來總結這三者的關係：

1.  **目標：** 我們要開發一個自訂的「**區塊 (Block)**」。
2.  **工具：** 我們使用 **React** 這個函式庫來建構這個區塊在編輯器中的互動介面。
3.  **語法：** 我們使用 **JSX** 這種語法糖 (Syntactic Sugar) 來更輕鬆、更直觀地撰寫 React 元件的 UI 結構。

``
*（示意圖：一個簡單的流程圖，顯示「開發者使用 JSX 語法」->「撰寫 React 元件」->「構成一個 Gutenberg 區塊」。）*

理解了 **Block**、**React** 和 **JSX** 這三個核心觀念，你就拿到了進入現代 WordPress 開發大門的鑰匙。在接下來的課程中，我們將動手設定開發環境，並使用 `**@wordpress/scripts**` 工具來建立我們的第一個自訂區塊！