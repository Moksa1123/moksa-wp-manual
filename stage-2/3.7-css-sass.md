# 03.07 (進階) SASS 介紹與環境建置

你好！歡迎來到 MoksaWP 網站設計與進階客製化課程。從這個章節開始，我們將進入前端開發的進階領域。過去我們直接撰寫 CSS 來調整網站樣式，雖然直觀，但在大型專案中會變得難以維護。今天，我們要學習一個強大的工具，它將徹底改變你寫樣式的方式——**SASS**。

SASS (Syntactically Awesome Style Sheets) 是一種 **CSS 預處理器 (CSS Preprocessor)**，它為 CSS 增加了許多程式語言的特性，例如變數、巢狀結構、函式等。你寫的是 SASS 語法，然後透過「編譯」的過程，將它轉換成瀏覽器看得懂的標準 CSS 檔案。這讓我們能用更有效率、更有組織、更易於維護的方式來管理專案的全部樣式。

---

### 什麼是 SASS？為什麼要用它？

簡單來說，SASS 是 **「加強版的 CSS」**。它解決了原生 CSS 的幾個痛點：

1.  **程式碼重複 (Repetition):** 傳統 CSS 中，你可能需要不斷重複相同的顏色代碼、字體設定。
2.  **缺乏組織 (Organization):** 當 `style.css` 檔案變得越來越大（幾千行），尋找和修改特定樣式會變成一場惡夢。
3.  **難以維護 (Maintenance):** 專案需求變更時（例如：更換品牌主色），你可能需要手動修改數十個地方，費時又容易出錯。

SASS 透過以下幾個核心功能來解決這些問題：

*   **變數 (Variables):** 將常用的值（如顏色、字體大小、間距）存儲在變數中，實現「一處修改，全局生效」。
*   **巢狀語法 (Nesting):** 讓你可以像 HTML 結構一樣，將子選擇器的樣式寫在父選擇器的內部，程式碼更直觀、更整潔。
*   **模組化 (Partials & Import):** 將 CSS 拆分成多個小檔案（例如 `_header.scss`, `_buttons.scss`），再由一個主檔案將它們全部匯入，大幅提升組織性。
*   **混合 (Mixins):** 類似程式設計中的函式，可以定義一組可重複使用的 CSS 宣告，並在需要時呼叫它。
*   **繼承 (Inheritance):** 讓一個選擇器可以繼承另一組選擇器的所有樣式，減少重複的程式碼。

> **Moksa 技巧：** SASS 有兩種語法格式：`.sass` (舊式，不使用大括號和分號) 和 `.scss` (新式，完全相容 CSS)。在 Moksa，我們**強烈推薦使用 `.scss` 格式**，因為它的語法和原生 CSS 完全一樣，你可以將現有的 `.css` 檔案直接改名為 `.scss` 就開始使用 SASS 的強大功能，學習曲線更平緩。

---

### 環境建置：在 VS Code 中自動編譯 SASS

要讓 SASS 語法轉換成 CSS，我們需要一個「編譯器」。與其使用複雜的命令列工具，Moksa 推薦一個對初學者非常友善的整合方案：在我們的標準開發工具 **VS Code** 中安裝擴充功能。

**準備工作：**
*   確認你已經安裝了 **Visual Studio Code (VS Code)**。
*   擁有一個使用 **LocalWP** 建立的本地 WordPress 站點。
*   已經為你的主題（例如 Kadence）安裝並啟用了一個**子主題 (Child Theme)**。**這非常重要**，我們所有的客製化樣式都應該寫在子主題中。

#### 步驟 1: 安裝 VS Code 擴充功能「Live Sass Compiler」

「Live Sass Compiler」是一個非常受歡迎的擴充功能，它會在背景「監視」你的 `.scss` 檔案，一旦你存檔，它就會自動將其編譯成 `.css` 檔案。

1.  打開 VS Code。
2.  點擊左側活動欄的「擴充功能」圖示 (四個方塊的圖案)。
3.  在搜尋框中輸入 `Live Sass Compiler`。
4.  找到由 Ritwick Dey 開發的擴充功能，點擊「**安裝 (Install)**」。

``

#### 步驟 2: 設定 Live Sass Compiler 的輸出路徑

預設情況下，編譯後的 CSS 檔案會和你的 SCSS 檔案放在同一個資料夾。但這不符合 WordPress 的規範。我們需要**讓編譯後的 `style.css` 檔案輸出到子主題的根目錄**，以覆蓋主題原有的樣式表。

1.  在 VS Code 中，點擊左下角的「齒輪」圖示，選擇「**設定 (Settings)**」。
2.  在右上角點擊「**開啟設定 (JSON)**」圖示，進入 `settings.json` 檔案。
``
3.  將以下這段 **Moksa 推薦設定** 複製並貼到 `settings.json` 的大括號 `{}` 內。如果裡面已經有其他設定，請確保這段程式碼加在最後，並注意 JSON 格式的逗號。

    ```json
    "liveSassCompile.settings.formats": [
        {
            "format": "expanded",
            "extensionName": ".css",
            "savePath": "/"
        }
    ],
    "liveSassCompile.settings.generateMap": false,
    "liveSassCompile.settings.autoprefix": [
        "> 1%",
        "last 2 versions"
    ]
    ```

4.  **設定說明：**
    *   `"format": "expanded"`：編譯出的 CSS 是易於閱讀的、未壓縮的格式。
    *   `"extensionName": ".css"`：編譯後的副檔名是 `.css`。
    *   `"savePath": "/"`：**這是最關鍵的設定**。它告訴編譯器，將編譯後的檔案儲存到**相對於工作區 (workspace) 的根目錄**。當我們用 VS Code 打開「子主題資料夾」時，根目錄就是子主題的根目錄。
    *   `"generateMap": false`：我們暫時不需要 source map 檔案。
    *   `"autoprefix"`：自動為 CSS 屬性加上瀏覽器前綴（如 `-webkit-`），增加相容性。

#### 步驟 3: 在子主題中建立 SCSS 檔案結構

良好的檔案結構是專案成功的基礎。我們不會把所有 SCSS 都寫在一個檔案裡。

1.  使用 VS Code 的檔案總管，在你的子主題資料夾中，建立一個名為 `scss` 的新資料夾。
2.  在 `scss` 資料夾內，建立一個主檔案，命名為 `style.scss`。**注意**：這個檔案將會被編譯成子主題根目錄的 `style.css`。
3.  **Moksa 技巧：** 為了更好地組織程式碼，我們通常會建立一個 `partials` (或 `components`) 資料夾來存放模組化的小檔案。在 `scss` 資料夾內，再建立一個名為 `partials` 的資料夾。
4.  在 `partials` 資料夾內，建立一個變數檔案，命名為 `_variables.scss`。**檔名前的底線 `_`** 是 SASS 的一個慣例，它告訴編譯器：「這是一個 partial 檔案，不需要單獨編譯它，它會被其他檔案匯入」。

你的檔案結構現在看起來應該是這樣：

```
kadence-child/
├── scss/
│   ├── partials/
│   │   └── _variables.scss
│   └── style.scss
├── functions.php
├── screenshot.png
└── style.css  <-- 這個檔案將會被自動產生和覆蓋
```
``

---

### 實際演練：撰寫並編譯你的第一支 SCSS

現在環境都設定好了，讓我們來實際操作一次。

#### 步驟 1: 定義變數

打開 `scss/partials/_variables.scss` 檔案，並貼上以下內容：

```scss
// ==========================================================================
// Variables
// ==========================================================================

// Colors
$primary-color: #0050ff;
$secondary-color: #f5a623;
$text-color: #333;

// Fonts
$font-family-base: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
$font-size-base: 16px;

// Breakpoints
$breakpoint-md: 768px;
$breakpoint-lg: 1024px;
```

存檔。你會發現什麼事都沒發生，這是正常的，因為 `_variables.scss` 是一個 partial 檔案，不會被單獨編譯。

#### 步驟 2: 撰寫並匯入主樣式

打開 `scss/style.scss` 檔案，貼上以下內容。

```scss
/*
 Theme Name:   Kadence Child
 Theme URI:    https://www.kadencethemes.com/
 Description:  A child theme for the Kadence Theme
 Author:       Your Name
 Author URI:   https://yourwebsite.com
 Template:     kadence
 Version:      1.0.0
*/

// Import Partials
@import 'partials/variables';

// ==========================================================================
// Base Styles
// ==========================================================================

body {
    font-family: $font-family-base;
    color: $text-color;
    font-size: $font-size-base;
}

a {
    color: $primary-color;
    text-decoration: none;

    &:hover {
        color: darken($primary-color, 10%);
        text-decoration: underline;
    }
}

// Example of Nesting
.site-header {
    padding: 20px;

    .site-branding {
        .site-title a {
            color: $secondary-color;
        }
    }
}
```

注意看，我們在檔案最上方使用 `@import` 匯入了變數檔案。接著在下面的樣式中，我們直接使用了 `$primary-color` 這些變數，並展示了巢狀語法 (`a:hover` 和 `.site-header` 的部分)。`darken()` 是 SASS 內建的顏色函式，可以將顏色變暗 10%。

#### 步驟 3: 啟動編譯！

現在，最神奇的時刻來了！

1.  確認你正在 `style.scss` 檔案的編輯畫面。
2.  看到 VS Code 視窗最下方的狀態列，點擊「**Watch Sass**」按鈕。
``
3.  點擊後，你會看到 VS Code 的「輸出 (OUTPUT)」面板彈出，顯示 "Watching..."，代表它已經開始監視檔案變更。
4.  同時，你會發現子主題根目錄下的 `style.css` 檔案內容已經被自動更新了！

打開 `style.css`，你會看到 SASS 編譯器為我們產生的標準 CSS：
``
```css
/*
 Theme Name:   Kadence Child
 Theme URI:    https://www.kadencethemes.com/
 Description:  A child theme for the Kadence Theme
 Author:       Your Name
 Author URI:   https://yourwebsite.com
 Template:     kadence
 Version:      1.0.0
*/
body {
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
  color: #333;
  font-size: 16px;
}

a {
  color: #0050ff;
  text-decoration: none;
}
a:hover {
  color: #0039b7;
  text-decoration: underline;
}

.site-header {
  padding: 20px;
}
.site-header .site-branding .site-title a {
  color: #f5a623;
}
```

恭喜你！你已經成功建立了 SASS 開發環境，並完成了第一次編譯。從現在開始，你只需要專心在 `scss` 資料夾中撰寫你的樣式，存檔後 `style.css` 就會自動更新。這將大幅提升你的開發效率與程式碼品質。