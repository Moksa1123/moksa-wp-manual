# 04.06 (實務) 頁面編輯器的效能陷阱與優化

大家好，我是 Moksa 的首席課程導師。在之前的章節中，我們學會了如何使用像 Elementor 和 Kadence Blocks 這樣的頁面編輯器，來打造出視覺上令人驚艷的網頁。它們的拖放功能確實徹底改變了我們建立網站的方式，讓我們可以像設計師一樣，直觀地排版頁面。

然而，這種便利性背後，往往隱藏著一個不可忽視的代價——**網站效能**。如果使用不當，頁面編輯器會產生大量冗餘的程式碼、載入不必要的檔案，最終導致網站速度變慢，影響使用者體驗與 SEO 排名。

這堂課的目標，就是要帶你深入了解這些「效能陷阱」，並學習如何利用 Moksa 技術棧中的工具（如 WP Rocket, ShortPixel），建立一個既美觀又快速的網站。

---

### 為什麼頁面編輯器會拖慢網站速度？

在我們動手優化之前，必須先理解問題的根源。頁面編輯器之所以可能影響效能，主要有以下幾個原因：

1.  **過多的 DOM 元素 (Excessive DOM Nodes):**
    *   為了實現複雜的排版和拖放功能，頁面編輯器（特別是傳統的 Elementor）會產生層層包裹的 HTML 標籤（通常是 `<div>`）。例如，一個簡單的按鈕，可能被包裹在 `Widget > Column > Inner Section > Section` 等多層結構中。瀏覽器需要花更多時間去解析這些複雜的結構，進而拖慢頁面渲染速度。

2.  **載入大量且未經整理的 CSS 與 JavaScript:**
    *   你放在頁面上的每一個小工具（Widget），都可能帶著自己專屬的 CSS（樣式）和 JavaScript（互動效果）檔案。即使你只用了一個小工具的某個小功能，它可能還是會載入一整個檔案庫。當頁面上充滿各種小工具時，瀏覽器就需要下載和執行數十個甚至上百個檔案，造成嚴重的效能瓶頸。

3.  **肥大的頁面尺寸 (Large Page Size):**
    *   上述兩點，加上未經優化的圖片、影片、字體等媒體資源，會共同導致整個頁面的總下載大小變得非常龐大。對手機使用者或網路速度較慢的訪客來說，這會導致非常久的白畫面等待時間。

4.  **過多的資料庫查詢 (Database Queries):**
    *   某些動態小工具（例如：顯示最新文章、產品輪播）需要在每次頁面載入時，向 WordPress 資料庫發出請求。如果一個頁面上有太多這類小工具，就會增加伺服器的處理時間，拖慢整體反應速度。

---

### 常見的五大效能陷阱

了解原理後，讓我們來看看在實際操作中，最容易踩到的幾個效能地雷：

*   **陷阱一：無止盡的巢狀結構 (Infinite Nesting)**
    *   為了對齊某個元素，就不斷地使用「內部區段 (Inner Section)」，這是 Elementor 新手最常犯的錯誤。這會產生災難性的 DOM 結構。

*   **陷阱二：濫用動態效果與動畫**
    *   滑鼠懸停效果、頁面載入動畫、區塊入場動畫、背景影片、圖片輪播 (Slider)... 這些效果雖然酷炫，但它們是效能殺手。它們大量依賴 JavaScript，容易造成頁面佈局的位移（CLS），嚴重影響 Google 的 Core Web Vitals 分數。

*   **陷阱三：使用未經優化的巨大圖片**
    *   直接上傳用相機或手機拍攝的 2MB、5MB 的高解析度照片，是效能的頭號殺手。一張圖片的大小，可能就比整個網站的其他程式碼加起來還要大。

*   **陷阱四：安裝過多的編輯器附加元件 (Addons)**
    *   為了追求某個特定功能，安裝了五花八門的 Elementor Addons。每一個 Addon 都會為你的網站增加額外的 CSS 和 JS 負擔，即使你只用了其中一個小工具。

*   **陷阱五：忽略全域設定，濫用行內樣式 (Inline Styles)**
    *   不去設定網站的全域字體和顏色，而是在每一個標題、每一段文字、每一個按鈕上手動設定顏色和字型大小。這會產生大量重複且無法快取的 CSS 碼，讓程式碼變得臃腫。

---

### Moksa 實戰優化流程 (SOP)

理論說完了，現在讓我們捲起袖子，一步步地來優化我們的網站。

#### 步驟 1：基準測試 - 了解你的敵人

在進行任何優化之前，我們必須先量測目前的網站速度，這樣才能在優化後進行比對，確認我們的努力是否有效。

1.  開啟 **Google Chrome 的無痕模式**，避免瀏覽器快取和擴充功能影響測試結果。
2.  前往 [Google PageSpeed Insights](https://pagespeed.web.dev/)。
3.  輸入你網站上一個用頁面編輯器製作的、內容最豐富的頁面網址（例如首頁或某個銷售頁）。
4.  執行分析，並將「行動裝置」和「電腦版」的分數、以及 **LCP (最大內容繪製)**、**CLS (累計版面配置位移)** 等 Core Web Vitals 指標截圖或記錄下來。這就是我們的「**優化前**」數據。

``
*（範例：優化前 PageSpeed Insights 的慘淡分數）*

#### 步驟 2：啟用頁面編輯器內建的優化功能

許多現代的頁面編輯器已經意識到效能問題，並內建了一些優化選項。

*   **對於 Elementor 使用者：**
    1.  前往 WordPress 後台 > **Elementor** > **設定** > **功能 (Features)**。
    2.  找到「**效能**」區塊。
    3.  **務必**將以下選項設定為「**啟用 (Active)**」：
        *   **優化 DOM 輸出 (Optimized DOM Output):** 減少 `<div>` 的層級。
        *   **改進的素材資源載入 (Improved Asset Loading):** 僅在需要時載入相關的 JS 程式庫。
        *   **改進的 CSS 載入 (Improved CSS Loading):** 僅載入頁面上使用到的小工具的 CSS。
    4.  儲存設定後，前往 **Elementor** > **工具**，點擊「**再生 CSS 與資料**」按鈕，並清除你的快取。

``
*（Elementor 效能設定的截圖）*

*   **對於 Kadence Blocks 使用者：**
    1.  Kadence Blocks 的架構本身就比 Elementor 來得輕量，產生的 DOM 結構也更乾淨。
    2.  你可以前往 **外觀** > **自訂** > **一般** > **效能**。
    3.  **勾選**「**在頁首載入 CSS**」，這有助於改善 FCP (首次內容繪製) 時間。

#### 步驟 3：部署 WP Rocket - 你的效能瑞士刀

**WP Rocket** 是我們 Moksa 技術棧中最強大的效能優化外掛，它能完美解決頁面編輯器產生的 CSS/JS 臃腫問題。

1.  前往 **設定** > **WP Rocket** > **檔案最佳化**。

2.  **CSS 檔案** 設定區塊：
    *   勾選「**壓縮 CSS 檔案 (Minify CSS files)**」。
    *   **Moksa 技巧：** **最重要的一步！** 勾選「**最佳化 CSS 傳遞 (Optimize CSS delivery)**」，並選擇「**移除未使用的 CSS (Remove Unused CSS)**」。
        *   這個功能會自動掃描每一個頁面，分析哪些 CSS 樣式是真的有被用到，然後為該頁面產生一個專屬、極度輕量的 CSS 檔案。這對於充滿小工具的頁面編輯器來說，效果**極其顯著**。

3.  **JavaScript 檔案** 設定區塊：
    *   勾選「**壓縮 JavaScript 檔案 (Minify JavaScript files)**」。
    *   勾選「**延後載入 JavaScript (Load JavaScript deferred)**」。這會讓非必要的 JS 檔案延後到頁面主要內容都呈現完畢後再載入，大幅提升感官上的載入速度和 LCP 分數。
    *   勾選「**延遲執行 JavaScript (Delay JavaScript execution)**」。這會延遲載入第三方程式碼（如 Facebook Pixel, Google Analytics, 即時客服...），直到使用者有互動（如滾動、點擊）為止。

``
*（WP Rocket 檔案最佳化設定的截圖，特別圈出「移除未使用的 CSS」）*

#### 步驟 4：使用 ShortPixel 進行終極圖片優化

再厲害的快取外掛，也救不了一個充滿巨大圖片的網頁。

1.  確保你已經安裝並設定好 **ShortPixel** 外掛。
2.  在 **設定** > **ShortPixel** > **一般**，確認壓縮類型為「**有損 (Lossy)**」，這是畫質與檔案大小平衡最佳的選項。
3.  **Moksa 技巧：** 前往 **進階 (Advanced)** 頁籤，**務必勾選**以下兩個選項：
    *   **WebP 圖片:** 勾選「**同時也建立 WebP 版本的圖片**」。WebP 是 Google 開發的現代圖片格式，檔案大小通常比 JPG 小 30% 以上，且畫質幾乎無損。
    *   **優化視網膜圖片:** 如果你的佈景主題有產生 `@2x` 的高解析度圖片，也一併優化它們。
4.  設定完成後，WP Rocket 會自動偵測到 ShortPixel 產生的 WebP 圖片，並在支援的瀏覽器上優先提供 WebP 格式，無縫提升圖片載入效能。

``
*（ShortPixel 設定 WebP 的截圖）*

#### 步驟 5：驗收成果 - 重新檢測與分析

完成以上所有設定後：

1.  在 WP Rocket 的控制台點擊「**清除快取 (Clear Cache)**」。
2.  再次開啟**新的 Chrome 無痕視窗**，回到 Google PageSpeed Insights。
3.  測試同一個頁面網址。
4.  現在，將你的「**優化後**」分數與「**優化前**」的數據做比較。你會驚訝地發現分數有著戲劇性的提升，特別是在 LCP、總網頁大小 (Total Page Size) 和請求數量 (Requests) 這些關鍵指標上。

``
*（範例：優化後 PageSpeed Insights 的綠色分數）*

---

### 總結與最佳實踐

工具只是輔助，更重要的是建立「效能優先」的設計思維。

*   **從簡設計：** 不是所有頁面都需要複雜的排版。對於部落格文章、關於我們、隱私權政策等頁面，**優先使用原生的區塊編輯器 (Gutenberg) 搭配 Kadence Blocks**，它的效能遠勝於 Elementor。只有在需要高度客製化排版的首頁或銷售頁，才動用 Elementor。
*   **克制使用動態效果：** 問問自己：「這個入場動畫真的能幫助使用者完成轉換嗎？」如果答案是否定的，就果斷移除它。
*   **養成優化圖片的習慣：** 在上傳圖片前，先用工具（如 Photoshop 的「轉存為網頁用」或線上工具 Squoosh）調整尺寸和壓縮。然後再交給 ShortPixel 做最後的自動化處理。
*   **定期審核外掛：** 每隔半年檢查一次網站安裝了哪些 Elementor Addons，移除那些只用上一兩次就不再需要的外掛。

記住，**網站速度就是使用者體驗，而好的使用者體驗，就是轉換率的保證**。掌握了今天學到的技巧，你就能在享受頁面編輯器帶來便利的同時，打造出一個讓使用者和搜尋引擎都喜愛的快速網站。