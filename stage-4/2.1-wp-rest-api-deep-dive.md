# 02.01 WordPress REST API 深度解析 (含 v2 API 與驗證機制：應用程式密碼)

大家好，我是 Moksa 的首席課程導師。

歡迎來到 n8n 與 WordPress 協作的全新章節。在我們正式開始用 n8n 打造強大的自動化流程之前，我們必須先打好地基，而這個地基就是 **WordPress REST API**。理解它，是釋放 WordPress 全部潛能、讓它與外部服務（如 n8n）順暢溝通的關鍵。

在這堂課，我們將深入探討什麼是 REST API，它的結構是什麼，以及最重要的——如何安全地進行驗證，讓 n8n 能夠代表你來操作網站資料。

---

### 1. 什麼是 WordPress REST API？

想像一下你的 WordPress 網站是一間設備齊全、運作高效的廚房。廚房裡有各種食材（文章、頁面、產品、訂單）和廚師（WordPress 核心功能、外掛）。

而你現在在餐廳的座位上，想點一道「最新的 10 筆訂單」。你該怎麼跟廚房溝通呢？

這時候，**服務生 (Waiter)** 就出現了。你用一種標準的語言（菜單上的菜名）告訴服務生你的需求，服務生進入廚房，用廚房內部能理解的方式下單，然後把做好的菜（資料）端回給你。

在這個比喻中：
*   **你 (顧客):** 外部應用程式，例如 n8n、手機 App 或任何其他系統。
*   **服務生 (Waiter):** 就是 **REST API**。
*   **標準的點餐語言:** 就是 API 的「**端點 (Endpoint)**」和「**請求方法 (Request Method)**」。
*   **廚房:** WordPress 網站本身。
*   **菜 (資料):** 以 **JSON** (JavaScript Object Notation) 格式回傳的資料。

簡單來說，**WordPress REST API 是一套標準化的溝通協議，它允許外部應用程式透過 HTTP 請求，以一種安全、可預測的方式來讀取 (Read)、新增 (Create)、更新 (Update) 和刪除 (Delete) 你網站上的資料。**

**Moksa 技巧：** 我們在課程中提到的所有與外部服務的整合，例如 FluentCRM 與其他平台的串接、OrderChatz 把訂單資料送到 LINE、n8n 觸發網站動作等等，幾乎都是透過 REST API 來完成的。學會它，等於學會了 WordPress 的「通用語言」。

### 2. API 端點 (Endpoint) 的結構解析

每一個 API 請求都必須指向一個特定的 URL，我們稱之為「**端點 (Endpoint)**」。了解它的結構至關重要。

一個典型的 WordPress REST API v2 端點看起來像這樣：

`https://yourdomain.com/wp-json/wp/v2/posts`

讓我們來拆解這個結構：

*   `https://yourdomain.com`: 你的網站網址。
*   `/wp-json/`: 這是所有 WordPress REST API 請求的**固定前綴 (Prefix)**。看到這個路徑，WordPress 就知道這是一個 API 請求。
*   `/wp/v2/`: 這部分被稱為「**命名空間 (Namespace)**」與「**版本 (Version)**」。
    *   `wp`: 代表這是由 WordPress 核心提供的 API。如果是 WooCommerce，這裡可能會是 `wc`。
    *   `v2`: 代表 API 的版本號。這是目前最穩定且通用的版本。
*   `/posts`: 這部分被稱為「**路由 (Route)**」或「**資源 (Resource)**」。它指定了你想要操作的資料類型。例如：
    *   `/posts`: 文章
    *   `/pages`: 頁面
    *   `/users`: 使用者
    *   `/orders`: (需要 WooCommerce) 訂單
    *   `/products`: (需要 WooCommerce) 產品

所以，當你向 `https://yourdomain.com/wp-json/wp/v2/posts` 發出一個 `GET` 請求時，你其實是在說：「嘿，WordPress，請把你的文章列表用 JSON 格式給我。」

### 3. 公開資料 vs. 私密資料與驗證的必要性

並不是所有的 API 端點都可以被任何人隨意存取。

*   **公開資料 (Public Data):** 像文章、產品列表這類本來就是公開給訪客看的內容，通常不需要驗證就可以透過 API **讀取 (GET)**。
*   **私密資料 (Private Data):** 像是使用者列表、訂單詳情、網站設定等，或是任何需要**寫入、修改、刪除**的操作 (例如新增一篇文章、更新訂單狀態)，都必須經過嚴格的「**驗證 (Authentication)**」。

驗證的目的，就是要向 WordPress 證明：「**我是合法的管理者，請允許我執行這個操作。**」

如果沒有驗證機制，任何人都可以透過 API 隨意刪除你的文章或竊取客戶資料，那將是一場災難。

### 4. (實作) 最佳驗證機制：應用程式密碼 (Application Passwords)

過去，WordPress API 有多種驗證方式，但對於像 n8n 這種伺服器對伺服器的自動化連線，目前**最推薦、最安全、也最方便**的方式就是「**應用程式密碼 (Application Passwords)**」。

它有幾個巨大的優點：
*   **獨立性:** 它是一組專門給某個應用程式（例如 n8n）使用的獨立密碼，與你的管理者登入密碼無關。
*   **安全性:** 即使這組密碼外洩，你也可以隨時從 WordPress 後台「撤銷」它，而不會影響你的主要登入密碼。
*   **可追蹤:** 你可以為不同的應用程式建立不同的密碼（例如一個給 n8n，一個給手機 App），方便管理。

接下來，讓我們一步步建立一個給 n8n 專用的應用程式密碼。

#### 步驟 1: 登入並前往個人資料頁面

首先，請使用你的**管理員帳號**登入 WordPress 後台。

接著，從左側選單點擊「**使用者**」 > 「**個人資料**」。

``
*截圖位置：顯示 WordPress 後台，滑鼠指標停在「個人資料」選單上。*

#### 步驟 2: 找到「應用程式密碼」區塊

將頁面往下捲動，你會找到一個標題為「**應用程式密碼 (Application Passwords)**」的區塊。

``
*截圖位置：顯示個人資料頁面中「應用程式密碼」的區塊。*

#### 步驟 3: 建立新的應用程式密碼

在這個區塊中，你會看到一個「**新的應用程式密碼名稱**」的輸入框。

**Moksa 技巧：** 請務必給它一個有意義的名稱，這樣你未來才知道這組密碼是做什麼用的。例如，我們可以命名為 `n8n Automation`。

填寫完名稱後，點擊旁邊的「**新增應用程式密碼**」按鈕。

``
*截圖位置：在輸入框中填寫 "n8n Automation"，並標示出「新增應用程式密碼」按鈕。*

#### 步驟 4: 複製並妥善保管密碼

點擊按鈕後，系統會**立刻**產生一組密碼。**請注意：這組密碼只會顯示這一次！**

你必須**立刻複製**這組密碼，並將它存放在一個安全的地方，例如你的密碼管理器 (1Password, Bitwarden 等)。**千萬不要**把它存放在純文字檔案或輕易洩漏的地方。

``
*截圖位置：顯示成功產生密碼的畫面，並用紅色框線和箭頭強調「這組密碼只會顯示一次，請立即複製」。*

**格式提醒：** 產生的密碼通常會包含空格，例如 `abcd efgh ijkl mnop qrst uvwx`。在使用時，**請務必移除所有空格**，變成 `abcdefghijklmnopqrstuvwx`。

太棒了！你現在擁有了一組專門用於 API 驗證的「鑰匙」。這組鑰匙包含兩個部分：
1.  **使用者名稱 (Username):** 就是你目前登入的 WordPress 管理員帳號名稱。
2.  **密碼 (Password):** 就是你剛剛產生的那串「**應用程式密碼**」。

在接下來的課程中，當我們在 n8n 中設定 WordPress 連線節點時，就會用到這組帳號和應用程式密碼。

### 總結

恭喜你完成了打通 WordPress 與外部世界橋樑的第一步！

在這堂課，我們學到了：
*   REST API 如同網站的「服務生」，負責在外部應用與網站核心之間傳遞指令和資料。
*   API 端點 (Endpoint) 有著 `yourdomain.com/wp-json/namespace/v2/resource` 的標準結構。
*   基於安全考量，任何修改或讀取私密資料的操作都需要「驗證」。
*   「應用程式密碼」是目前最適合 n8n 這類自動化工具使用的驗證方式，兼具安全與便利。

有了這些基礎知識，你已經準備好在下一堂課中，實際於 n8n 裡設定 WordPress Credential，並發出你的第一個 API 請求了！我們下堂課見！