# **02.02 (實作) 使用 n8n 專用節點讀寫 WordPress/WooCommerce 資料**

哈囉，歡迎來到 n8n 與 WordPress 協作的實作課程！

在上一堂課，我們已經成功地安裝並啟動了 n8n。從這堂課開始，我們將正式進入最令人興奮的部分：讓 n8n 與你的 WordPress/WooCommerce 網站進行溝通。

n8n 內建了 WordPress 與 WooCommerce 兩種專用節點。請注意，這兩個節點雖然都作用在同一個網站上，但它們所需的\*\*「鑰匙（憑證）」是不一樣的\*\*：

* **WordPress 節點**：用於發文章、管理媒體、操作一般頁面。使用 **應用程式密碼 (Application Password)**。  
* **WooCommerce 節點**：用於管理訂單、商品、客戶。使用 **REST API 金鑰 (Consumer Key / Secret)**。

本教學將帶你一次搞定這兩種設定。

## **Part 1: 設定 WordPress 節點憑證 (Application Password)**

為了讓 n8n 安全地操作你的 WordPress 文章與頁面，我們需要建立一組專用的應用程式密碼。

### **步驟 1：取得應用程式密碼 (WordPress 後台)**

1. 登入 WordPress 後台，前往「**使用者**」 \> 「**個人資料**」。  
2. 捲動到頁面下方的「**應用程式密碼 (Application Passwords)**」區塊。  
3. 在「新應用程式密碼名稱」輸入 n8n Automation，點擊「**新增應用程式密碼**」。  
4. **重要：** 系統會顯示一組 xxxx xxxx xxxx ... 的密碼。請**立即複製**這組密碼，它只會顯示這一次。

### **步驟 2：在 n8n 建立 WordPress 憑證**

1. 回到 n8n，點擊左側「**Credentials**」\>「**Add credential**」。  
2. 搜尋並選擇「**WordPress API**」。  
3. 填入以下資訊：  
   * **User:** 你的 WordPress 登入帳號 (Username)。  
   * **Password:** 剛剛複製的應用程式密碼 (Application Password)。  
   * **URL:** 你的網站完整網址 (例如 https://moksaweb.com)。  
4. 點擊「**Save**」。

## **Part 2: 設定 WooCommerce 節點憑證 (Consumer Key/Secret)**

若你要處理電商資料（訂單、庫存），必須使用 WooCommerce 專屬的 API 金鑰，這與上方的 WordPress 憑證不同。

### **步驟 1：檢查固定網址 (Permalinks) 設定**

**這是官方文件強調的重點！** WooCommerce API 必須在非預設的網址結構下才能運作。

1. 前往 WordPress 後台 \> 「**設定**」 \> 「**固定網址**」。  
2. 確保設定**不是**「一般 (Plain)」。建議選擇「**文章名稱 (Post name)**」。  
3. 點擊「儲存變更」。

### **步驟 2：產生 REST API 金鑰 (WooCommerce 後台)**

1. 前往「**WooCommerce**」 \> 「**設定**」 \> 「**進階**」標籤 \> 「**REST API**」。  
2. 點擊「**新增金鑰**」。  
3. 設定內容：  
   * **描述：** n8n WooCommerce  
   * **使用者：** 選擇管理員帳號  
   * **權限：** 建議選擇「**讀取/寫入 (Read/Write)**」，這樣才能修改訂單或庫存。  
4. 點擊「**產生 API 金鑰**」。  
5. **重要：** 請複製畫面上的 **Consumer Key (ck\_...)** 與 **Consumer Secret (cs\_...)**。

### **步驟 3：在 n8n 建立 WooCommerce 憑證**

1. 回到 n8n，點擊左側「**Credentials**」\>「**Add credential**」。  
2. 搜尋並選擇「**WooCommerce API**」。  
3. 填入以下資訊：  
   * **Consumer Key:** 貼上 ck\_ 開頭的序號。  
   * **Consumer Secret:** 貼上 cs\_ 開頭的序號。  
   * **URL:** 你的網站完整網址 (需包含 https://)。  
4. 點擊「**Save**」。

## **Part 3: 實作演練 (一) \- 讀取 WooCommerce 訂單**

有了憑證，我們來試著抓取最新的 5 筆訂單。

### **步驟 1：建立 WooCommerce 節點**

1. 在 n8n 畫布新增一個 WooCommerce 節點。  
2. **Credential for WooCommerce API:** 選擇剛建立的 WooCommerce API 憑證。

### **步驟 2：設定操作**

* **Resource:** Order  
* **Operation:** Get Many

### **步驟 3：設定篩選 (Options)**

1. 點擊 Options 下方的 Add Option。  
2. 選擇 Per Page，填入 5 (代表抓取最新 5 筆)。  
3. 點擊 Execute Node，你應該會看到訂單的 JSON 資料。

## **Part 4: 實作演練 (二) \- 自動發佈 WordPress 文章**

接著我們使用 WordPress 節點來自動發文。

### **步驟 1：建立 WordPress 節點**

1. 新增一個 WordPress 節點。  
2. **Credential for WordPress API:** 選擇 WordPress API 憑證。

### **步驟 2：設定操作與內容**

* **Resource:** Post  
* **Operation:** Create  
* **Title:** 輸入測試標題，例如 Hello from n8n。  
* **Content:** 輸入文章內容。  
* **Status:** 選擇 Publish (直接發佈)。

### **步驟 3：執行**

點擊 Execute Node，檢查網站是否出現新文章。

## **Part 5: 實作演練 (三) \- 更新 WooCommerce 商品庫存**

這是電商自動化最經典的場景：根據 SKU 更新庫存。

### **步驟 A：用 SKU 尋找商品 ID**

1. 新增 WooCommerce 節點。  
2. **Operation:** Get Many (Resource: Product)。  
3. **Options:** 新增 SKU 選項，並填入你要搜尋的商品 SKU (例如 TSHIRT-001)。  
4. 執行節點，取得該商品的 id。

### **步驟 B：更新該 ID 的庫存**

1. 在後方再接一個 WooCommerce 節點。  
2. **Operation:** Update (Resource: Product)。  
3. **Product ID:** 使用表達式連結上一個節點的 id。  
4. **Update Fields:**  
   * 新增 Stock Quantity，填入新的庫存數量 (例如 50)。  
   * 新增 Manage Stock，設為 True。  
5. 執行節點，庫存即時更新完成！

## **常見問題與錯誤排除 (Troubleshooting)**

如果在連線時遇到問題，請參考以下官方建議解法：

### **1\. 錯誤訊息：Consumer key is missing**

如果你在連接 WooCommerce 時遇到此錯誤，即使你已經填寫了 Key，通常是因為伺服器或資安外掛剝離了 Authorization 標頭。

* 解法 (n8n 端)：  
  在 n8n 的 WooCommerce 憑證設定頁面中，開啟 「Include Credentials in Query」 選項。這會強制將 Key 放在網址參數中傳送，通常能解決此問題。

### **2\. 錯誤訊息：Sorry, you are not allowed to list resources**

* **原因**：API Key 的權限不足。  
* **解法**：回到 WooCommerce API 設定，確保該 Key 的權限是 **「讀取/寫入 (Read/Write)」**，而不僅僅是「讀取」。

### **3\. 404 Error 或連線失敗**

* **原因**：WordPress 的固定網址 (Permalinks) 設定錯誤。  
* **解法**：前往 WordPress 後台 \> 設定 \> 固定網址，確保**不是**選擇「一般 (Plain)」。建議設為「文章名稱 (Post name)」。

Moksa 技巧：  
如果專用節點一直無法連線，但你需要急用，可以使用 n8n 的 HTTP Request 節點。在 Authentication 方法中選擇 Basic Auth，Username 填寫 Consumer Key，Password 填寫 Consumer Secret，通常可以繞過某些專用節點的解析問題。

## **結論與 Moksa 技巧**

今天，你學會了使用 n8n 專用節點對 WordPress/WooCommerce 進行基礎但極為重要的「讀、寫、更新」操作。從讀取訂單、自動發佈文章到同步庫存，這些都是打造自動化商業流程的基石。

**Moksa 技巧：**

WordPress 和 WooCommerce 節點雖然強大，但它們並沒有涵蓋 WordPress REST API 的所有功能。

當你未來遇到節點不支援的操作時（例如，更新一個特殊的自訂欄位，或是觸發特定的外掛功能），請記得你永遠可以使用通用的 **「HTTP Request」** 節點。

你只需要查閱 WordPress 或 WooCommerce 的官方 REST API 文件，就可以使用 HTTP Request 節點手動發出請求，來完成任何節點無法做到的事情。這讓 n8n 的可能性變得無限大。

在下一堂課，我們將探索更多實用的觸發器與節點，組合出更強大的自動化流程。繼續加油！
