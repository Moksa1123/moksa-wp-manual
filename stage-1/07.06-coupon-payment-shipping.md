# 7.6 (實務) 應用 4：依「付款方式」或「運送方式」折扣

你好，我是 Moksa 的首席課程導師。

在經營電商時，我們時常會需要針對「特定的結帳行為」來提供優惠，藉此引導顧客完成我們期望的動作。例如，為了降低金流手續費成本或減少未付款的棄單，我們可能會想鼓勵顧客「使用信用卡付款」；或者，為了簡化出貨流程，我們可能會鼓勵顧客選擇「7-11 超商取貨」。

傳統 WooCommerce 的優惠券功能無法做到這一點，它只能針對商品、分類或總金額做折扣。但別擔心，透過 **Moksa 技術棧**中的 **Advanced Coupons** 外掛，我們就能輕鬆實現這個強大的行銷策略。

這堂課，我們將會實作兩個最常見的應用場景：

1.  **付款方式折扣**：當顧客選擇「信用卡」付款時，整筆訂單享 95 折。
2.  **運送方式折扣**：當顧客選擇「7-11 超商取貨」時，購物車總金額直接折抵 $30 元。

---

### 前置準備

在開始之前，請確保你的網站已經安裝並啟用以下外掛：

*   **WooCommerce** (核心功能)
*   **Advanced Coupons for WooCommerce (Premium)**：這是實現此功能的核心外掛，免費版沒有這個功能。
*   **綠界科技 ECPay 金流** (用於付款方式折扣的範例)
*   **RY Tools** (用於運送方式折扣的範例)

### 核心觀念：購物車條件 (Cart Conditions)

Advanced Coupons 的強大之處在於它的「**購物車條件 (Cart Conditions)**」功能。這個功能允許你設定非常精細的規則，**只有當購物車中的所有條件都滿足時，優惠券才會生效**。

我們要利用的條件就是「**付款方式 (Payment Gateway)**」和「**運送方式 (Shipping Method)**」。

``

---

### 實作一：鼓勵使用信用卡，訂單享 95 折

這個策略的目標是**提高訂單的即時付款率**，減少因 ATM 忘記匯款而產生的訂單被取消的狀況。

#### **步驟 1：建立新優惠券**

1.  從 WordPress 後台，前往 `行銷 (Marketing)` > `優惠券 (Coupons)`。
2.  點擊 `新增優惠券 (Add Coupon)`。

#### **步驟 2：設定基本折扣資訊**

1.  **優惠券代碼 (Coupon code)**：輸入一個好記的代碼，例如 `CREDITCARD5OFF`。
2.  **描述 (Description)** (選填，但建議填寫)：方便你日後管理，例如「限信用卡付款，全站 95 折」。
3.  在下方的「**優惠券資料 (Coupon data)**」區塊中，找到「**一般 (General)**」頁籤。
4.  **折扣類型 (Discount type)**：選擇 `百分比折扣 (Percentage discount)`。
5.  **優惠券金額 (Coupon amount)**：輸入 `5` (代表 5%，也就是 95 折)。

``

#### **步驟 3：設定「購物車條件」**

1.  切換到「**購物車條件 (Cart Conditions)**」頁籤。
2.  點擊 `新增條件群組 (Add Condition Group)`。
3.  在第一條規則中，下拉選單選擇 `付款方式 (Payment Gateway)`。
4.  中間的條件選擇 `其中一個 (is one of)`。
5.  在最後的欄位，選擇你的信用卡付款方式。根據**綠界金流**的設定，通常會是 `綠界科技信用卡 (ECPay Credit Card)`。

> **Moksa 技巧：如何找到正確的付款方式名稱？**
> 如果你不確定付款方式的確切名稱，可以到 `WooCommerce` > `設定 (Settings)` > `付款 (Payments)` 頁籤，這裡會列出你網站上所有啟用的付款方式及其標題。請複製完整的標題貼到條件欄位中。

``

#### **步驟 4：發布與測試**

1.  點擊右上角的 `發布 (Publish)` 按鈕。
2.  現在，開啟一個新的瀏覽器「無痕視窗」，模擬顧客購物。
3.  將商品加入購物車，前往結帳頁面。
4.  在結帳頁面，先**不要**選擇任何付款方式，直接輸入優惠券代碼 `CREDITCARD5OFF`，你會看到系統提示「抱歉，此優惠券不適用於您的購物車。」
5.  接著，在付款方式中，點選 `綠界科技信用卡 (ECPay Credit Card)`。
6.  你會神奇地發現，優惠券立刻被觸發，訂單總金額也成功地打了 95 折！

---

### 實作二：選擇 7-11 取貨，現折 $30 元

這個策略的目標是**引導顧客選擇對你來說最方便或成本最低的物流方式**。

#### **步驟 1：建立新優惠券**

同樣地，前往 `行銷 (Marketing)` > `優惠券 (Coupons)`，點擊 `新增優惠券`。

#### **步驟 2：設定基本折扣資訊**

1.  **優惠券代碼 (Coupon code)**：`711SAVE30`。
2.  **描述 (Description)**：`限 7-11 超商取貨，訂單折抵 $30`。
3.  在「**一般 (General)**」頁籤中：
4.  **折扣類型 (Discount type)**：選擇 `固定購物車折扣 (Fixed cart discount)`。
5.  **優惠券金額 (Coupon amount)**：輸入 `30`。

``

#### **步驟 3：設定「購物車條件」**

1.  切換到「**購物車條件 (Cart Conditions)**」頁籤。
2.  點擊 `新增條件群組 (Add Condition Group)`。
3.  在第一條規則中，下拉選單選擇 `運送方式 (Shipping Method)`。
4.  中間的條件選擇 `其中一個 (is one of)`。
5.  在最後的欄位，選擇你的 7-11 取貨方式。根據 **RY Tools** 的設定，通常會是 `7-11 超商取貨 (C2C)`。

> **Moksa 技巧：如何找到正確的運送方式名稱？**
> 運送方式的名稱是在 `WooCommerce` > `設定 (Settings)` > `運送 (Shipping)` > `運送區域 (Shipping zones)` 中設定的。請確保你複製的名稱與你在這裡設定的「**方式標題 (Method title)**」完全一致。

``

#### **步驟 4：發布與測試**

1.  點擊 `發布 (Publish)`。
2.  同樣使用無痕視窗進行測試。
3.  在結帳頁面，當你選擇「宅配」或其他運送方式時，輸入優惠券會顯示無效。
4.  一旦你將運送方式切換為 `7-11 超商取貨 (C2C)`，優惠券就會自動生效，總金額扣除 $30 元。

---

### 總結與最佳實務

恭喜你！你已經學會如何運用 Advanced Coupons 的「購物車條件」來建立更聰明、更具引導性的行銷活動。

最後，提供幾個 **Moksa 技巧**與最佳實務：

1.  **明確告知顧客**：在網站的醒目位置（例如：頂部公告欄、活動頁面）清楚說明優惠內容，例如「本月使用信用卡付款，結帳輸入 `CREDITCARD5OFF` 即享 95 折！」。
2.  **組合多種條件**：你可以新增多個條件群組，創造更複雜的規則。例如：「**消費滿 $1000**」 **AND** 「**選擇信用卡付款**」，才能享有折扣。
3.  **務必親自測試**：在正式公告優惠活動前，永遠要自己走過一次完整的購物流程，確保優惠券的觸發條件如你預期般運作。
4.  **命名規則**：為你的優惠券建立一套命名規則，方便日後管理。例如 `PAY-CC-5OFF` (付款方式-信用卡-5%折扣)、`SHIP-711-30CASH` (運送方式-711-$30現金折扣)。

這個功能看似簡單，卻是優化營運流程與提升轉換率的利器。請務必動手實作，並思考如何將它應用在你的業務目標上。