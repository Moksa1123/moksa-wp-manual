# 5.4 (實作) 串接「RY Tools (Pro) for WooCommerce」物流外掛

你好，我是 Moksa 的首席課程導師。

在台灣，**超商取貨**（包含取貨付款）是電商最核心、最不可或缺的物流方式。它提供了極高的便利性，是提升顧客下單意願的關鍵功能。在這個章節，我們將一步步帶你完成 Moksa 團隊最推薦的超商物流解決方案——「**RY Tools (Pro) for WooCommerce**」的完整串接設定。

為什麼我們推薦 RY Tools？因為它穩定、功能完整，並且直接串接了 7-ELEVEN 的「交貨便」與全家 FamilyMart 的「店到店」官方 API，能讓你的網站擁有與大型電商平台完全相同的門市選擇體驗。

**學習目標：**

*   安裝並啟用 RY Tools Pro 外掛。
*   取得 7-ELEVEN 與全家 FamilyMart 的 API 金鑰。
*   在 WooCommerce 中設定超商取貨的運送方式。
*   在前台結帳頁面實際測試門市選擇功能。

---

### 前置作業

在開始之前，請確保你已經完成以下兩項準備工作：

1.  **購買並下載 RY Tools Pro：** 你需要前往 RY Tools 官方網站購買 Pro 版本，並從你的帳戶後台下載外掛的 `.zip` 檔案。
2.  **申請物流商會員：**
    *   **7-ELEVEN:** 註冊 [E-Tracking (交貨便)](https://myship.7-11.com.tw/MyShip/Shipinfo) 會員。
    *   **全家 FamilyMart:** 註冊 [E-Retail (店到店)](https://www.famiport.com.tw/Web_Famiport/page/famiport_online.aspx) 會員。

> **Moksa 提醒：** 申請物流商會員與 API 可能需要一些審核時間，建議可以提早處理。

---

### 步驟 1：安裝與啟用 RY Tools Pro 外掛

首先，我們需要將下載好的外掛安裝到你的 WordPress 網站中。

1.  登入 WordPress 後台，前往「**外掛**」>「**安裝外掛**」。
2.  點擊頁面上方的「**上傳外掛**」按鈕。
3.  點擊「**選擇檔案**」，並選擇你剛剛從 RY Tools 官網下載的 `.zip` 壓縮檔。
4.  點擊「**立即安裝**」，並在安裝完成後點擊「**啟用外掛**」。

啟用後，系統通常會引導你輸入**授權碼 (License Key)**。請將你在 RY Tools 官網購買後取得的授權碼貼上，並點擊啟用。這是接收外掛未來更新與技術支援的必要步驟。

``
*（示意圖：啟用 RY Tools Pro 外掛並輸入授權碼的畫面）*

---

### 步驟 2：設定物流商 API 金鑰

這是整個串接流程中最核心的環節。我們需要將從 7-ELEVEN 與全家後台取得的 API 金鑰，填入 RY Tools 的設定欄位中，建立起你的網站與物流系統之間的橋樑。

1.  從 WordPress 後台，前往「**WooCommerce**」>「**設定**」>「**運送方式**」。
2.  在運送方式的子選單中，點擊「**RY 超商取貨**」。

``
*（示意圖：WooCommerce 設定中，找到「RY 超商取貨」的頁籤）*

現在，我們來分別設定兩大超商的 API。

#### 設定 7-ELEVEN (交貨便)

1.  在「RY 超商取貨」的設定頁面中，找到 **7-ELEVEN C2C (交貨便) 設定** 的區塊。
2.  登入你的 [7-ELEVEN E-Tracking (交貨便)](https://myship.7-11.com.tw/MyShip/Shipinfo) 後台。
3.  在後台中，找到 API 串接相關的設定頁面，並複製以下三組金鑰：
    *   `ECPlatform`
    *   `HashKey`
    *   `HashIV`
4.  將這三組金鑰**依序**貼到 RY Tools 設定頁面中對應的欄位。
    *   **廠商後台網址 (ECPlatform)：** 貼上 `ECPlatform`。
    *   **API 串接金鑰 (HashKey)：** 貼上 `HashKey`。
    *   **API 串接 IV (HashIV)：** 貼上 `HashIV`。
5.  **Moksa 技巧：** 填寫完畢後，務必點擊欄位旁的「**API 測試**」按鈕。如果看到「連線成功」的綠色提示，代表金鑰無誤。如果失敗，請仔細檢查是否有複製到空格或貼錯欄位。

``
*（示意圖：RY Tools 中填寫 7-ELEVEN API 金鑰的畫面，並標示出 API 測試按鈕）*

#### 設定 全家 FamilyMart (店到店)

1.  在同一個設定頁面，往下找到 **全家 FamilyMart C2C (店到店) 設定** 的區塊。
2.  登入你的 [全家 E-Retail (店到店)](https://www.famiport.com.tw/Web_Famiport/page/famiport_online.aspx) 後台。
3.  在後台中，找到 API 相關設定，並複製以下金鑰：
    *   `StoreID` (您的商店代號)
    *   `TempPickUpStoreID` (退貨門市店號)
    *   `HashKey`
    *   `HashIV`
4.  將金鑰貼到 RY Tools 中對應的欄位。
    *   **商店代號 (StoreID)：** 貼上 `StoreID`。
    *   **預設退貨門市店號 (TempPickUpStoreID)：** 填寫你希望的退貨門市店號。
    *   **API 串接金鑰 (HashKey)：** 貼上 `HashKey`。
    *   **API 串接 IV (HashIV)：** 貼上 `HashIV`。
5.  同樣地，點擊「**API 測試**」按鈕，確認連線成功。
6.  完成兩家超商的設定後，滑到頁面最下方，點擊「**儲存設定**」。

---

### 步驟 3：在 WooCommerce 新增運送方式

API 串接完成後，我們還需要在 WooCommerce 的「運送區域」中，正式啟用超商取貨這個選項，這樣顧客在結帳時才能看見並選取。

1.  前往「**WooCommerce**」>「**設定**」>「**運送方式**」>「**運送區域**」。
2.  找到你設定的運送區域（通常是「台灣」），點擊「**編輯**」。
``
*（示意圖：WooCommerce 運送區域列表）*
3.  在「運送方式」的區塊，點擊「**新增運送方式**」按鈕。
4.  在跳出的視窗中，從下拉選單裡選擇你想要新增的物流選項。RY Tools 已經幫我們準備好了：
    *   **RY 7-ELEVEN C2C** (7-11 取貨付款 / 純取貨)
    *   **RY FamilyMart C2C** (全家 取貨付款 / 純取貨)
5.  選擇完畢後，點擊「**新增運送方式**」。你可以重複此步驟，將 7-ELEVEN 和全家都加上。

``
*（示意圖：從下拉選單中選擇「RY 7-ELEVEN C2C」）*

6.  新增完成後，將滑鼠移到該運送方式上，點擊「**編輯**」。
7.  在編輯畫面中，你可以自訂幾個重要欄位：
    *   **方法標題：** 這是顧客在結帳頁面會看到的名稱，可以修改成更友善的文字，例如「7-ELEVEN 超商取貨 (付款/純取貨)」。
    *   **費用：** 設定這項運送方式的運費，例如 `60`。
    *   **啟用取貨付款：** **務必勾選**此項，並在「**取貨付款手續費**」欄位填 `0` (除非你要額外收費)，這樣顧客才能選擇貨到付款。

``
*（示意圖：編輯「RY 7-ELEVEN C2C」運送方式的設定畫面，包含費用與啟用取貨付款）*

8.  設定完成後，記得點擊「**儲存設定**」。

---

### 步驟 4：前台結帳流程測試

所有後台設定都完成了，現在讓我們回到網站前台，模擬顧客的購物流程，確保一切運作正常。

1.  開啟一個新的瀏覽器視窗 (建議使用無痕模式)。
2.  將任一商品加入購物車，並前往「**結帳**」頁面。
3.  在「**運送方式**」區塊，你現在應該能清楚地看到剛剛設定的「7-ELEVEN 超商取貨」與「全家超商取貨」選項，以及對應的運費。
4.  選擇其中一個超商物流，例如「7-ELEVEN 超商取貨」。
5.  你會看到下方出現一個「**選擇門市**」的按鈕。
6.  點擊「**選擇門市**」，畫面上應該會彈出 7-ELEVEN 官方的電子地圖選擇視窗。
``
*（示意圖：結帳頁面顯示超商物流選項，以及點擊後彈出的官方電子地圖）*
7.  在地圖上選擇一間門市後，送出選擇。
8.  你會看到結帳頁面自動帶入了你選擇的門市名稱與地址。
9.  確認無誤後，你可以使用測試金流（例如：**綠界 ECPay** 的「貨到付款」或測試信用卡號）下一筆訂單，完整走完流程。

恭喜你！你已經成功為你的 WooCommerce 網站串接了台灣最主流的超商物流系統。現在，你的顧客可以享受到方便快捷的超商取貨服務了。

在下一個章節，我們將會教學如何在後台管理這些超商取貨訂單，包含如何列印托運單，以及如何更新訂單狀態。