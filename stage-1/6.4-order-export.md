# 6.4 (實務) 訂單資料匯出 (會計/報稅用)

嗨，各位學員，歡迎來到網站營運的關鍵一環：財務管理。當你的 WooCommerce 網站開始穩定接單後，定期將訂單資料匯出，提供給會計師進行對帳與報稅，就成了一項非常重要的例行公事。

這堂課的目標，就是要教你如何從 WooCommerce 中，匯出 **一份符合會計師或國稅局標準的、乾淨且完整的訂單報表**。我們會介紹兩種方法，從內建的基本功能，到 Moksa 團隊推薦的專業外掛，讓你能夠根據自己的需求，高效地完成這項任務。

---

### 方法一：使用 WooCommerce 內建匯出功能 (基本)

WooCommerce 本身就內建了訂單匯出的功能，它位於「數據分析 (Analytics)」中。這個方法最快，不需要安裝任何額外外掛，適合只需要基本資料的場合。

#### 操作步驟

*   **步驟 1：前往數據分析儀表板**
    *   從 WordPress 後台左側選單，點擊「**數據分析 (Analytics)**」 > 「**訂單 (Orders)**」。
    *   ``

*   **步驟 2：篩選你要的訂單範圍**
    *   在頁面頂部，你可以看到一個「**日期範圍 (Date range)**」的篩選器。
    *   點擊它，選擇你要匯出的時間區間，例如「上個月 (Last month)」、「上一季 (Last quarter)」，或是自訂一個特定的日期範圍。這對於會計作帳非常重要，因為通常是按月或按季處理。
    *   ``

*   **步驟 3：下載 CSV 報表**
    *   設定好日期後，捲動到頁面右上方，你會看到一個「**下載 (Download)**」按鈕。
    *   點擊這個按鈕，系統就會自動將你篩選出的訂單資料，匯出成一個 `.csv` 檔案。

#### 內建功能的優點與限制

*   **優點：**
    *   **快速簡單**：不用安裝任何東西，三個步驟就能完成。
    *   **無需費用**：完全免費。
*   **限制：**
    *   **欄位有限**：匯出的欄位是固定的，你無法自訂。
    *   **缺乏關鍵資訊**：**最關鍵的「綠界電子發票號碼」不會包含在內**。同時，也可能缺少你需要的其他外掛自訂欄位 (例如：RY Tools 的超商門市資訊)。

對於需要提交正式報稅資料的商家來說，內建功能往往不敷使用。因此，我們更推薦方法二。

---

### 方法二：Moksa 推薦 - 使用專業匯出外掛 (進階/必學)

為了克服內建功能的限制，我們會使用一款功能強大的專業匯出外掛：「**WooCommerce Customer / Order / Coupon Export**」。這款外掛可以讓你**完全自訂匯出的欄位、格式、排程**，確保產出的報表 100% 符合會計需求。

#### 步驟 1：安裝與啟用外掛

*   請先從官方管道取得並安裝「**WooCommerce Customer / Order / Coupon Export**」外掛。
*   安裝並啟用後，從後台左側選單，找到「**WooCommerce**」 > 「**Export**」，進入外掛的設定畫面。
*   ``

#### 步驟 2：建立一個「會計專用」的匯出範本

這個外掛最棒的地方就是可以建立多個匯出「範本 (Preset)」。我們可以建立一個專門給會計師的範本，以後每個月或每季只要點一下按鈕就能完成匯出。

1.  在 Export 頁面，點擊「**New Export**」。
2.  在「**Export type**」選擇「**Order**」。
3.  在「**Export filename**」欄位，為你的檔案取一個好辨識的名稱，例如 `orders-export-%Y-%m-%d` (這會自動帶入匯出當天的日期)。
4.  在「**Format**」部分，選擇「**CSV**」，並**務必勾選「Include a UTF-8 BOM」**。
    *   **Moksa 技巧**：勾選這個選項是為了**防止你的 Excel 或 Google Sheets 打開 CSV 檔時，中文字元變成亂碼**。這是一個非常常見的錯誤，請務必記得。

#### 步驟 3：篩選與設定匯出欄位 (核心步驟)

這是整個流程中最重要的一步，我們要告訴系統「需要匯出哪些資料」。

1.  **篩選訂單 (Filtering orders):**
    *   在「**Filter your orders**」區塊，你可以設定非常精細的篩選條件。
    *   最重要的就是「**Order date**」。你可以設定一個固定的日期範圍，例如 `2024-04-01` 到 `2024-06-30` (第二季報稅)。
    *   你也可以篩選「**Order status**」，一般來說，會計只需要匯出「**已完成 (Completed)**」的訂單。
    *   ``

2.  **選擇欄位 (Order columns):**
    *   向下捲動到「**Set up your export format**」 > 「**Order columns**」。
    *   這裡會列出所有可以匯出的欄位。你可以透過拖拉來排序，或點擊「Remove」來移除不需要的欄位。
    *   **Moksa 推薦的會計必備欄位：**
        *   `order_number`：訂單編號
        *   `order_date`：訂單日期
        *   `status`：訂單狀態 (方便再次確認)
        *   `billing_full_name`：顧客姓名
        *   `total`：**訂單總金額 (含稅)**
        *   `subtotal`：商品小計 (未稅或含稅，依你的設定而定)
        *   `cart_discount_amount`：使用的優惠券金額
        *   `shipping_total`：運費
        *   `payment_method_title`：付款方式 (e.g., 綠界信用卡, LINE Pay)
        *   `shipping_method_title`：運送方式 (e.g., 7-11 超商取貨)
        *   **`_ecpay_invoice_number`：綠界電子發票號碼 (最重要的欄位！)**
    *   **Moksa 技巧：如何加入發票號碼？**
        *   綠界電子發票號碼是儲存在訂單的「**自訂欄位 (Custom Meta)**」中。
        *   在欄位選擇器中，點擊「**Add Field**」。
        *   在「**Field Type**」選擇「**Order Meta**」。
        *   在「**Meta Key**」中，手動輸入 `_ecpay_invoice_number`。
        *   給這個欄位一個名稱，例如 `ecpay_invoice_no`。
        *   這樣，匯出的報表中就會包含每一筆訂單對應的發票號碼了！
    *   ``

#### 步驟 4：儲存範本並執行匯出

1.  設定好所有欄位後，捲動到頁面最下方。
2.  你可以點擊「**Save Preset**」將這次的設定儲存起來，下次就不用再重設一次。為它取個名字，例如「**會計師月報表**」。
3.  最後，點擊「**Export**」按鈕，系統就會開始處理並讓你下載設定好的 CSV 檔案。

---

### 後續處理：在試算表軟體中開啟

下載 CSV 檔案後，你可以使用 Microsoft Excel 或 Google Sheets 來開啟它。

*   **Google Sheets:** 直接匯入即可，通常不會有亂碼問題。
*   **Microsoft Excel (Windows):** 如果你打開後發現中文是亂碼，代表在上一步你可能忘了勾選 `Include a UTF-8 BOM`。請回到外掛設定中確認。另一個解法是，不要直接雙擊打開 CSV，而是用 Excel 的「資料」 > 「從文字/CSV」功能來匯入，並在檔案來源格式選擇「**65001: Unicode (UTF-8)**」。

``

### 總結

對一位專業的電商營運者來說，能否產出一份乾淨、正確的財務報表，是體現專業度的重要指標。

*   **日常快速查看**：使用 WooCommerce **內建匯出**功能。
*   **正式會計/報稅**：務必使用 **WooCommerce Customer / Order / Coupon Export** 這類專業外掛，才能確保包含「**發票號碼**」等關鍵資訊。

建立好你的「會計專用匯出範本」後，未來每個月或每季的報稅工作，都將變得輕鬆且不容易出錯。這項技能將為你省下大量的時間，也讓你的會計師更愛你！